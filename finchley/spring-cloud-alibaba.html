<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Spring Cloud Alibaba Reference Documentation</title><link rel="stylesheet" type="text/css" href="css/manual-singlepage.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div lang="en" class="book"><div class="titlepage"><div><div><h1 class="title"><a name="d0e3"></a>Spring Cloud Alibaba Reference Documentation</h1></div><div><span xmlns:d="http://docbook.org/ns/docbook" class="author"><span class="firstname">Jim Fang, Jing Xiao, Mercy Ma, Xiaolong Zuo, Bingting Peng, Yuxin Wang</span></span></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="chapter"><a href="#_introduction">1. Introduction</a></span></dt><dt><span class="chapter"><a href="#_dependency_management">2. Dependency Management</a></span></dt><dt><span class="chapter"><a href="#_spring_cloud_alibaba_nacos_discovery">3. Spring Cloud Alibaba Nacos Discovery</a></span></dt><dd><dl><dt><span class="section"><a href="#_service_registration_discovery_nacos_discovery">3.1. Service Registration/Discovery: Nacos Discovery</a></span></dt><dt><span class="section"><a href="#_how_to_introduce_nacos_discovery_for_service_registration_discovery">3.2. How to Introduce Nacos Discovery for service registration/discovery</a></span></dt><dt><span class="section"><a href="#_an_example_of_using_nacos_discovery_for_service_registration_discovery_and_call">3.3. An example of using Nacos Discovery for service registration/discovery and call</a></span></dt><dd><dl><dt><span class="section"><a href="#_nacos_server_startup">3.3.1. Nacos Server Startup</a></span></dt><dt><span class="section"><a href="#_start_a_provider_application">3.3.2. Start a Provider Application</a></span></dt><dt><span class="section"><a href="#_start_a_consumer_application">3.3.3. Start a Consumer Application</a></span></dt></dl></dd><dt><span class="section"><a href="#_nacos_discovery_endpoint">3.4. Nacos Discovery Endpoint</a></span></dt><dt><span class="section"><a href="#_more_information_about_nacos_discovery_starter_configurations">3.5. More Information about Nacos Discovery Starter Configurations</a></span></dt></dl></dd><dt><span class="chapter"><a href="#_spring_cloud_alibaba_nacos_config">4. Spring Cloud Alibaba Nacos Config</a></span></dt><dd><dl><dt><span class="section"><a href="#_how_to_introduce_nacos_config_for_configuration">4.1. How to Introduce Nacos Config for configuration</a></span></dt><dt><span class="section"><a href="#_quickstart">4.2. Quickstart</a></span></dt><dd><dl><dt><span class="section"><a href="#_initialize_nacos_server">4.2.1. Initialize Nacos Server</a></span></dt><dd><dl><dt><span class="section"><a href="#_usage_on_the_client">Usage on the Client</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="#_add_configurations_with_dataid_in_yaml_format">4.3. Add Configurations with DataId in YAML Format</a></span></dt><dt><span class="section"><a href="#_support_dynamic_configuration_udpates">4.4. Support Dynamic Configuration Udpates</a></span></dt><dt><span class="section"><a href="#_support_configurations_at_the_profile_level">4.5. Support configurations at the profile level</a></span></dt><dt><span class="section"><a href="#_support_custom_namespaces">4.6. Support Custom Namespaces</a></span></dt><dt><span class="section"><a href="#_support_custom_groups">4.7. Support Custom Groups</a></span></dt><dt><span class="section"><a href="#_support_custom_data_id">4.8. Support Custom Data Id</a></span></dt><dt><span class="section"><a href="#_nacos_config_endpoint">4.9. Nacos Config Endpoint</a></span></dt><dt><span class="section"><a href="#_disable_nacos_config_autoconfiguration">4.10. Disable Nacos Config AutoConfiguration</a></span></dt><dt><span class="section"><a href="#_more_information_about_nacos_config_starter_configurations">4.11. More Information about Nacos Config Starter Configurations</a></span></dt></dl></dd><dt><span class="chapter"><a href="#_spring_cloud_alibaba_sentinel">5. Spring Cloud Alibaba Sentinel</a></span></dt><dd><dl><dt><span class="section"><a href="#_introduction_of_sentinel">5.1. Introduction of Sentinel</a></span></dt><dt><span class="section"><a href="#_how_to_use_sentinel">5.2. How to Use Sentinel</a></span></dt><dd><dl><dt><span class="section"><a href="#_sentinel_dashboard">5.2.1. Sentinel Dashboard</a></span></dt><dd><dl><dt><span class="section"><a href="#_get_the_dashboard">Get the Dashboard</a></span></dt><dt><span class="section"><a href="#_start_the_dashboard">Start the Dashboard</a></span></dt></dl></dd><dt><span class="section"><a href="#_configure_the_dashboard">5.2.2. Configure the Dashboard</a></span></dt></dl></dd><dt><span class="section"><a href="#_openfeign_support">5.3. OpenFeign Support</a></span></dt><dt><span class="section"><a href="#_resttemplate_support">5.4. RestTemplate Support</a></span></dt><dt><span class="section"><a href="#_dynamic_data_source_support">5.5. Dynamic Data Source Support</a></span></dt><dt><span class="section"><a href="#_support_zuul">5.6. Support Zuul</a></span></dt><dt><span class="section"><a href="#_support_spring_cloud_gateway">5.7. Support Spring Cloud Gateway</a></span></dt><dt><span class="section"><a href="#_sentinel_endpoint">5.8. Sentinel Endpoint</a></span></dt><dt><span class="section"><a href="#_configuration">5.9. Configuration</a></span></dt></dl></dd><dt><span class="chapter"><a href="#_spring_cloud_alibaba_dubbo">6. Spring Cloud Alibaba Dubbo</a></span></dt><dd><dl><dt><span class="section"><a href="#_introduction_2">6.1. Introduction</a></span></dt><dt><span class="section"><a href="#_features">6.2. Features</a></span></dt><dt><span class="section"><a href="#_reference">6.3. Reference</a></span></dt></dl></dd><dt><span class="chapter"><a href="#_spring_cloud_alibaba_rocketmq_binder">7. Spring Cloud Alibaba RocketMQ Binder</a></span></dt><dd><dl><dt><span class="section"><a href="#_introduction_of_rocketmq">7.1. Introduction of RocketMQ</a></span></dt><dt><span class="section"><a href="#_rocketmq_usages">7.2. RocketMQ Usages</a></span></dt><dt><span class="section"><a href="#_introduction_of_spring_cloud_stream">7.3. Introduction of Spring Cloud Stream</a></span></dt><dt><span class="section"><a href="#_how_to_use_spring_cloud_alibaba_rocketmq_binder">7.4. How to use Spring Cloud Alibaba RocketMQ Binder</a></span></dt><dt><span class="section"><a href="#_how_spring_cloud_alibaba_rocketmq_binder_works">7.5. How Spring Cloud Alibaba RocketMQ Binder Works</a></span></dt><dt><span class="section"><a href="#_support_messagesource">7.6. Support MessageSource</a></span></dt><dt><span class="section"><a href="#_configuration_options">7.7. Configuration Options</a></span></dt><dd><dl><dt><span class="section"><a href="#_rocketmq_binder_properties">7.7.1. RocketMQ Binder Properties</a></span></dt><dt><span class="section"><a href="#_rocketmq_consumer_properties">7.7.2. RocketMQ Consumer Properties</a></span></dt><dt><span class="section"><a href="#_rocketmq_provider_properties">7.7.3. RocketMQ Provider Properties</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#_spring_cloud_alibaba_cloud_ans">8. Spring Cloud Alibaba Cloud ANS</a></span></dt><dd><dl><dt><span class="section"><a href="#_how_to_introduce_spring_cloud_alibaba_cloud_ans">8.1. How to Introduce Spring Cloud Alibaba Cloud ANS</a></span></dt><dt><span class="section"><a href="#_use_ans_to_register_service">8.2. Use ANS to Register Service</a></span></dt><dt><span class="section"><a href="#_start_registration_center">8.3. Start Registration Center</a></span></dt><dd><dl><dt><span class="section"><a href="#_start_lightweight_configuration_center">8.3.1. Start Lightweight Configuration Center</a></span></dt><dt><span class="section"><a href="#_user_registration_center_on_the_cloud">8.3.2. User Registration Center on the Cloud</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#_spring_cloud_alibaba_cloud_acm">9. Spring Cloud Alibaba Cloud ACM</a></span></dt><dd><dl><dt><span class="section"><a href="#_how_to_introduce_spring_cloud_alibaba_cloud_acm">9.1. How to Introduce Spring Cloud Alibaba Cloud ACM</a></span></dt><dt><span class="section"><a href="#_use_acm_to_manage_configurations">9.2. Use ACM to Manage Configurations</a></span></dt><dd><dl><dt><span class="section"><a href="#_start_configuration_center">9.2.1. Start Configuration Center</a></span></dt><dd><dl><dt><span class="section"><a href="#_use_lightweight_configuration_center">Use Lightweight Configuration Center</a></span></dt><dt><span class="section"><a href="#_use_acm_on_the_alibaba_cloud">Use ACM on the Alibaba Cloud</a></span></dt></dl></dd><dt><span class="section"><a href="#_add_configuration_in_the_configuration_center">9.2.2. Add Configuration in the Configuration Center</a></span></dt><dt><span class="section"><a href="#_start_application_verification">9.2.3. Start Application Verification</a></span></dt></dl></dd><dt><span class="section"><a href="#_modify_configuration_file_extension">9.3. Modify Configuration File Extension</a></span></dt><dt><span class="section"><a href="#_dynamic_configuration_refresh">9.4. Dynamic Configuration Refresh</a></span></dt><dt><span class="section"><a href="#_configure_profile_granularity">9.5. Configure Profile Granularity</a></span></dt><dt><span class="section"><a href="#_support_custom_acm_timeout">9.6. Support Custom ACM Timeout</a></span></dt><dt><span class="section"><a href="#_support_custom_group_configurations">9.7. Support Custom Group Configurations</a></span></dt><dd><dl><dt><span class="section"><a href="#_support_shared_configurations">9.7.1. Support Shared Configurations</a></span></dt></dl></dd><dt><span class="section"><a href="#_actuator_endpoint">9.8. Actuator Endpoint</a></span></dt></dl></dd><dt><span class="chapter"><a href="#_spring_cloud_alibaba_cloud_oss">10. Spring Cloud Alibaba Cloud OSS</a></span></dt><dd><dl><dt><span class="section"><a href="#_how_to_introduce_spring_cloud_alibaba_cloud_oss">10.1. How to Introduce Spring Cloud Alibaba Cloud OSS</a></span></dt><dt><span class="section"><a href="#_how_to_use_oss_api">10.2. How to Use OSS API</a></span></dt><dd><dl><dt><span class="section"><a href="#_configure_oss">10.2.1. Configure OSS</a></span></dt><dt><span class="section"><a href="#_introduce_oss_api">10.2.2. Introduce OSS API</a></span></dt></dl></dd><dt><span class="section"><a href="#_integrate_with_the_resource_specifications_of_spring">10.3. Integrate with the Resource Specifications of Spring</a></span></dt><dt><span class="section"><a href="#_use_sts_authentication">10.4. Use STS Authentication</a></span></dt><dt><span class="section"><a href="#_more_configurations_for_the_client">10.5. More Configurations for the Client</a></span></dt></dl></dd><dt><span class="chapter"><a href="#_spring_cloud_alibaba_cloud_schedulerx">11. Spring Cloud Alibaba Cloud SchedulerX</a></span></dt><dd><dl><dt><span class="section"><a href="#_how_to_introduce_spring_cloud_alibaba_cloud_schedulerx">11.1. How to Introduce Spring Cloud Alibaba Cloud SchedulerX</a></span></dt><dt><span class="section"><a href="#_start_schedulerx">11.2. Start SchedulerX</a></span></dt><dt><span class="section"><a href="#_compile_a_simple_job">11.3. Compile a simple job</a></span></dt><dt><span class="section"><a href="#_job_scheduling">11.4. Job Scheduling</a></span></dt><dt><span class="section"><a href="#_usage_in_production_environment">11.5. Usage in Production Environment</a></span></dt></dl></dd><dt><span class="chapter"><a href="#_spring_cloud_alibaba_cloud_sms">12. Spring Cloud Alibaba Cloud SMS</a></span></dt><dd><dl><dt><span class="section"><a href="#_how_to_introduce_spring_cloud_alibaba_cloud_sms">12.1. How to Introduce Spring Cloud Alibaba Cloud SMS</a></span></dt><dt><span class="section"><a href="#_how_to_use_sms_api">12.2. How to use SMS API</a></span></dt><dd><dl><dt><span class="section"><a href="#_configure_sms">12.2.1. Configure SMS</a></span></dt><dt><span class="section"><a href="#_introduce_sms_api">12.2.2. Introduce SMS API</a></span></dt></dl></dd><dt><span class="section"><a href="#_the_advanced_features_of_sms_api">12.3. The Advanced Features of SMS Api</a></span></dt></dl></dd></dl></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="_introduction" href="#_introduction"></a>1.&nbsp;Introduction</h1></div></div></div><p>Spring Cloud Alibaba aims to provide a one-stop solution for microservices development. This prjoect includes the required components for developing distributed applications and services, so that developers can develop distributed applications easily with the Spring Cloud programming models.</p><p>With Spring Cloud Alibaba, you only need to add a few annotations and configurations, and you will be able to use the distributed solutions of Alibaba for your applications, and build a distributed system of your own with Alibaba middleware.</p><p>The features of Spring Cloud Alibaba:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><span class="strong"><strong>Flow control and service degradation</strong></span>&#65306;support WebServlet, WebFlux, OpenFeign, RestTemplate, Dubbo access to the function of limiting and degrading flow. It can modify the rules of limiting and degrading flow in real time through the console at run time, and it also supports the monitoring of limiting and degrading Metrics.</li><li class="listitem"><span class="strong"><strong>Service registration and discovery</strong></span>&#65306;Service can be registered and clients can discover the instances using Spring-managed beans, auto integration Ribbon.</li><li class="listitem"><span class="strong"><strong>Distributed configuration</strong></span>&#65306;support for externalized configuration in a distributed system, auto refresh when configuration changes.</li><li class="listitem"><span class="strong"><strong>Rpc Service</strong></span>&#65306;extend Spring Cloud client RestTemplate and OpenFeign to support calling Dubbo RPC services.</li><li class="listitem"><span class="strong"><strong>Event-driven</strong></span>&#65306;support for building highly scalable event-driven microservices connected with shared messaging systems.</li><li class="listitem"><span class="strong"><strong>Distributed Transaction</strong></span>&#65306;support for distributed transaction solution with high performance and ease of use.</li><li class="listitem"><span class="strong"><strong>Alibaba Cloud Object Storage</strong></span>&#65306;massive, secure, low-cost, and highly reliable cloud storage services. Support for storing and accessing any type of data in any application, anytime, anywhere.</li><li class="listitem"><span class="strong"><strong>Alibaba Cloud SchedulerX</strong></span>&#65306;accurate, highly reliable, and highly available scheduled job scheduling services with response time within seconds.</li><li class="listitem"><span class="strong"><strong>Alibaba Cloud SMS</strong></span>&#65306; A messaging service that covers the globe, Alibaba SMS provides convenient, efficient, and intelligent communication capabilities that help businesses quickly contact their customers.</li></ol></div><p>Spring Cloud Alibaba also provide rich <a class="link" href="https://github.com/alibaba/spring-cloud-alibaba/tree/master/spring-cloud-alibaba-examples" target="_top">examples</a>.</p></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="_dependency_management" href="#_dependency_management"></a>2.&nbsp;Dependency Management</h1></div></div></div><p>If you&#8217;re a Maven Central user, add our BOM to your pom.xml &lt;dependencyManagement&gt; section. This will allow you to omit versions for any of the Maven dependencies and instead delegate versioning to the BOM.</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependencyManagement&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependencies&gt;</span>
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependency&gt;</span>
            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;groupId&gt;</span>com.alibaba.cloud<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/groupId&gt;</span>
            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;artifactId&gt;</span>spring-cloud-alibaba-dependencies<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/artifactId&gt;</span>
            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;version&gt;</span>2.0.0.RELEASE<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/version&gt;</span>
            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;type&gt;</span>pom<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/type&gt;</span>
            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;scope&gt;</span>import<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/scope&gt;</span>
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependency&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependencies&gt;</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependencyManagement&gt;</span></pre><p>In the following sections, it will be assumed you are using the Spring Cloud Alibaba BOM and the dependency snippets will not contain versions.</p></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="_spring_cloud_alibaba_nacos_discovery" href="#_spring_cloud_alibaba_nacos_discovery"></a>3.&nbsp;Spring Cloud Alibaba Nacos Discovery</h1></div></div></div><p>Nacos is an easy-to-use dynamic service discovery, configuration and service management platform for building cloud native applications.</p><p>With Spring Cloud Alibaba Nacos Discovery, you can quickly access the Nacos service registration feature based on Spring Cloud&#8217;s programming model.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_service_registration_discovery_nacos_discovery" href="#_service_registration_discovery_nacos_discovery"></a>3.1&nbsp;Service Registration/Discovery: Nacos Discovery</h2></div></div></div><p>Service discovery is one of the key components in the microservices architecture. In such a architecture, configuring a service list for every client manually could be a daunting task, and makes dynamic scaling extremely difficult.
 Nacos Discovery helps you to register your service to the Nacos server automatically, and the Nacos server keeps track of the services and refreshes the service list dynamically. In addition, Nacos
Discovery registers some of the metadata of the service instance, such as host, port, health check URL, homepage to Nacos. For details about how to download and start Nacos, refer to the <a class="link" href="https://nacos.io/zh-cn/docs/quick-start.html" target="_top">Nacos Website</a>.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_how_to_introduce_nacos_discovery_for_service_registration_discovery" href="#_how_to_introduce_nacos_discovery_for_service_registration_discovery"></a>3.2&nbsp;How to Introduce Nacos Discovery for service registration/discovery</h2></div></div></div><p>please use the starter with the group ID as <code class="literal">com.alibaba.cloud</code> and the artifact ID as <code class="literal">spring-cloud-starter-alibaba-nacos-discovery</code>.</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependency&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;groupId&gt;</span>com.alibaba.cloud<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/groupId&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;artifactId&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/artifactId&gt;</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependency&gt;</span></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_an_example_of_using_nacos_discovery_for_service_registration_discovery_and_call" href="#_an_example_of_using_nacos_discovery_for_service_registration_discovery_and_call"></a>3.3&nbsp;An example of using Nacos Discovery for service registration/discovery and call</h2></div></div></div><p>Nacos Discovery integrate with the Netflix Ribbon, RestTemplate or OpenFeign can be used for service-to-service calls.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_nacos_server_startup" href="#_nacos_server_startup"></a>3.3.1&nbsp;Nacos Server Startup</h3></div></div></div><p>For details about how to download and start Nacos, refer to the <a class="link" href="https://nacos.io/zh-cn/docs/quick-start.html" target="_top">Nacos Website</a>.</p><p>After Nacos Server starts, go to <a class="link" href="http://ip:8848" target="_top">http://ip:8848</a> to view the console (default account name/password is nacos/nacos):</p><div class="figure"><a name="d0e132" href="#d0e132"></a><p class="title"><b>Figure&nbsp;3.1.&nbsp;Nacos Dashboard</b></p><div class="figure-contents"><div class="mediaobject"><img src="https://img.alicdn.com/tfs/TB1XEfwbQH0gK0jSZPiXXavapXa-2790-1060.png" alt="TB1XEfwbQH0gK0jSZPiXXavapXa 2790 1060"></div></div></div><br class="figure-break"><p>For more Nacos Server versions, you can download the latest version from <a class="link" href="https://github.com/alibaba/nacos/releases" target="_top">release page</a>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_start_a_provider_application" href="#_start_a_provider_application"></a>3.3.2&nbsp;Start a Provider Application</h3></div></div></div><p>The following sample illustrates how to register a service to Nacos.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Configuration of pom.xml The following is a complete example of pom.xml:</li></ul></div><pre class="screen">&lt;?xml version="1.0" encoding="UTF-8"? &gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;groupId&gt;open.source.test&lt;/groupId&gt;
    &lt;artifactId&gt;nacos-discovery-test&lt;/artifactId&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    &lt;name&gt;nacos-discovery-test&lt;/name&gt;

    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;${spring.boot.version}&lt;/version&gt;
        &lt;relativePath/&gt;
    &lt;/parent&gt;

    &lt;properties&gt;
        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
        &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;
        &lt;java.version&gt;1.8&lt;/java.version&gt;
    &lt;/properties&gt;

    &lt;dependencyManagement&gt;
        &lt;dependencies&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
                &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;
                &lt;version&gt;${spring.cloud.version}&lt;/version&gt;
                &lt;type&gt;pom&lt;/type&gt;
                &lt;scope&gt;import&lt;/scope&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
                &lt;artifactId&gt;spring-cloud-alibaba-dependencies&lt;/artifactId&gt;
                &lt;version&gt;${spring.cloud.alibaba.version}&lt;/version&gt;
                &lt;type&gt;pom&lt;/type&gt;
                &lt;scope&gt;import&lt;/scope&gt;
            &lt;/dependency&gt;
        &lt;/dependencies&gt;
    &lt;/dependencyManagement&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;
            &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;
&lt;/project&gt;</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Configuration of application.properties Some of the basic configurations of Nacos must be included in application.properties(or application.yaml), as shown below&#65306;
application.properties</li></ul></div><pre class="screen">server.port=8081
spring.application.name=nacos-producer
spring.cloud.nacos.discovery.server-addr=127.0.0.1:8848
management.endpoints.web.exposure.include=*</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>If you do not want to use Nacos for service registration and discovery, you can set <code class="literal">spring.cloud.nacos.discovery</code> to <code class="literal">false</code>.</p></td></tr></table></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">The following is a sample for starting Provider:</li></ul></div><pre class="screen">@SpringBootApplication
@EnableDiscoveryClient
public class NacosProviderDemoApplication {

    public static void main(String[] args) {
        SpringApplication.run(NacosProducerDemoApplication.class, args);
    }

    @RestController
    public class EchoController {
        @GetMapping(value = "/echo/{string}")
        public String echo(@PathVariable String string) {
            return "Hello Nacos Discovery " + string;
        }
    }
}</pre><p>Now you can see the registered services on the Nacos console.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Before you start the provider application, please start Nacos first. Refer to <a class="link" href="https://nacos.io/zh-cn/docs/quick-start.html" target="_top">Naco Website</a> for more details.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_start_a_consumer_application" href="#_start_a_consumer_application"></a>3.3.3&nbsp;Start a Consumer Application</h3></div></div></div><p>It might not be as easy as starting a provider application, because the consumer needs to call the RESTful service of the provider. In this example, we will use the most primitive way, that is,
combining the LoadBalanceClient and RestTemolate explicitly to access the RESTful service.
You can refer to section 1.2 for pom.xml and application.properties configurations. The following is the sample code for starting a consumer application.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>You can also access the service by using RestTemplate and FeignClient with load balancing.</p></td></tr></table></div><pre class="programlisting"><xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@SpringBootApplication</xslthl:annotation>
<xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@EnableDiscoveryClient</xslthl:annotation>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span> NacosConsumerApp {

    <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@RestController</xslthl:annotation>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span> NacosController{

        <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Autowired</xslthl:annotation>
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">private</span> LoadBalancerClient loadBalancerClient;
        <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Autowired</xslthl:annotation>
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">private</span> RestTemplate restTemplate;

        <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Value("${spring.application.name}")</xslthl:annotation>
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">private</span> String appName;

        <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@GetMapping("/echo/app-name")</xslthl:annotation>
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> String echoAppName(){
            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment">//Access through the combination of LoadBalanceClient and RestTemolate</span>
            ServiceInstance serviceInstance = loadBalancerClient.choose(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"nacos-provider"</span>);
            String path = String.format(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"http://%s:%s/echo/%s"</span>,serviceInstance.getHost(),serviceInstance.getPort(),appName);
            System.out.println(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"request path:"</span> +path);
            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">return</span> restTemplate.getForObject(path,String.<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span>);
        }

    }

    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment">//Instantiate RestTemplate Instance</span>
    <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Bean</xslthl:annotation>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> RestTemplate restTemplate(){

        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">return</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">new</span> RestTemplate();
    }

    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">static</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">void</span> main(String[] args) {

        SpringApplication.run(NacosConsumerApp.<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span>,args);
    }
}</pre><p>In this example, we injected a LoadBalancerClient instance, and instantiated a RestTemplate manually. At the same time, we injected the configuration value of <code class="literal">spring.application.name</code> into the application,
so that the current application name can be displayed when calling the service of the provider.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Please start Nacos before you start the consumer application. For details, please refer to <a class="link" href="https://nacos.io/zh-cn/docs/quick-start.html" target="_top">Nacos Website</a>.</p></td></tr></table></div><p>Next, access the <code class="literal"><a class="link" href="http://ip:port/echo/app-name" target="_top">http://ip:port/echo/app-name</a></code> interface provided by the consumer. Here we started the port of 8082. The access result is shown below&#65306;</p><pre class="literallayout">Address&#65306;http://127.0.0.1:8082/echo/app-name
Access result&#65306; Hello Nacos Discovery nacos-consumer</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_nacos_discovery_endpoint" href="#_nacos_discovery_endpoint"></a>3.4&nbsp;Nacos Discovery Endpoint</h2></div></div></div><p>Nacos Discovery provides an Endpoint internally with a corresponding endpoint id of <code class="literal">nacos-discovery</code>.</p><p>Endpoint exposed json contains two properties:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">subscribe: Shows the current service subscribers</li><li class="listitem">NacosDiscoveryProperties: Shows the current basic Nacos configurations of the current service</li></ol></div><p>The followings shows how a service instance accesses the Endpoint:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">{</span>
  <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"subscribe"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">[</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">{</span>
      <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"jsonFromServer"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">""</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
      <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"name"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"nacos-provider"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
      <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"clusters"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">""</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
      <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"cacheMillis"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">10000</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
      <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"hosts"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">[</span>
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">{</span>
          <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"instanceId"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"30.5.124.156#8081#DEFAULT#nacos-provider"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
          <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"ip"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"30.5.124.156"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
          <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"port"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">8081</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
          <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"weight"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">1.0</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
          <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"healthy"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">true</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
          <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"enabled"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">true</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
          <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"cluster"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">{</span>
            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"serviceName"</span>: null<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"name"</span>: null<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"healthChecker"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">{</span>
              <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"type"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"TCP"</span>
            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">},</span>
            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"defaultPort"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">80</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"defaultCheckPort"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">80</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"useIPPort4Check"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">true</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"metadata"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">{</span>

            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">}</span>
          <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">},</span>
          <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"service"</span>: null<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
          <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"metadata"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">{</span>

          <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">}</span>
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">}</span>
      ]<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
      <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"lastRefTime"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">1541755293119</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
      <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"checksum"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"e5a699c9201f5328241c178e804657e11541755293119"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
      <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"allIPs"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">false</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
      <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"key"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"nacos-producer"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
      <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"valid"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">true</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">}</span>
  ]<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
  <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"NacosDiscoveryProperties"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">{</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"serverAddr"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"127.0.0.1:8848"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"endpoint"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">""</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"namespace"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">""</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"logName"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">""</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"service"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"nacos-provider"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"weight"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">1.0</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"clusterName"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"DEFAULT"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"metadata"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">{</span>

    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">},</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"registerEnabled"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">true</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"ip"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"30.5.124.201"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"networkInterface"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">""</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"port"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">8082</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"secure"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">false</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"accessKey"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">""</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"secretKey"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">""</span>
  <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">}</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">}</span></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_more_information_about_nacos_discovery_starter_configurations" href="#_more_information_about_nacos_discovery_starter_configurations"></a>3.5&nbsp;More Information about Nacos Discovery Starter Configurations</h2></div></div></div><p>The following shows the other configurations of the starter of Nacos Discovery:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; " width="60%"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"><col class="col_4"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="top">Configuration</th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="top">Key</th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="top">Default Value</th><th style="border-bottom: 0.5pt solid ; " align="center" valign="top">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Server address</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.discovery.server-addr</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>IP and port of the Nacos Server listener</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Service name</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.discovery.service</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">${spring.application.name}</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Name the current service</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Weight</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.discovery.weight</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">1</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Value range: 1 to 100. The bigger the value, the greater the weight</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Network card name</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.discovery.network-interface</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>If the IP address is not specified, the registered IP address is the IP address of the network card. If this is not specified either, the IP address of the first network card will be used by default.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Registered IP address</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.discovery.ip</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Highest priority</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Registered port</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.discovery.port</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">-1</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Will be detected automatically by default. Do not need to be configured.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Namespace</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.discovery.namespace</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>A typical scenario is to isolate the service registration for different environment, such as resource (configurations, services etc.) isolation between testing and production environment</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>AccessKey</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.discovery.access-key</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Alibaba Cloud account accesskey</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>SecretKey</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.discovery.secret-key</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Alibaba Cloud account secretkey</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Metadata</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.discovery.metadata</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>You can define some of the metadata for your services in the Map format</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Log file name</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.discovery.log-name</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Endpoint</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.discovery.endpoint</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>The domain name of a certain service in a specific region. You can retrieve the server address dynamically with this domain name</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Integrate Ribbon or not</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">ribbon.nacos.enabled</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">true</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Set to true in most cases</p></td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>Enable Nacos Watch</p></td><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.discovery.watch.enabled</code></p></td><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">true</code></p></td><td style="" align="left" valign="top"><p>set to false to close watch</p></td></tr></tbody></table></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="_spring_cloud_alibaba_nacos_config" href="#_spring_cloud_alibaba_nacos_config"></a>4.&nbsp;Spring Cloud Alibaba Nacos Config</h1></div></div></div><p>Nacos is an easy-to-use dynamic service discovery, configuration and service management platform for building cloud native applications.</p><p>Use Spring Cloud Alibaba Nacos Config to quickly access Nacos configuration management capabilities based on Spring Cloud&#8217;s programming model.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_how_to_introduce_nacos_config_for_configuration" href="#_how_to_introduce_nacos_config_for_configuration"></a>4.1&nbsp;How to Introduce Nacos Config for configuration</h2></div></div></div><p>please use the starter with the group ID as <code class="literal">com.alibaba.cloud</code> and the artifact ID as <code class="literal">spring-cloud-starter-alibaba-nacos-config</code>.</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependency&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;groupId&gt;</span>com.alibaba.cloud<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/groupId&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;artifactId&gt;</span>spring-cloud-starter-alibaba-nacos-config<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/artifactId&gt;</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependency&gt;</span></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_quickstart" href="#_quickstart"></a>4.2&nbsp;Quickstart</h2></div></div></div><p>Nacos Config uses DataId and GROUP to determine a configuration.</p><p>The following figure shows that the DataId uses <code class="literal">myDataid</code>, GROUP uses <code class="literal">DEFAULT_GROUP</code>, and configures a configuration item of the format Properties:</p><div class="figure"><a name="d0e475" href="#d0e475"></a><p class="title"><b>Figure&nbsp;4.1.&nbsp;Nacos Config Item</b></p><div class="figure-contents"><div class="mediaobject"><img src="https://img.alicdn.com/tfs/TB1N2nxbRr0gK0jSZFnXXbRRXXa-2448-1194.png" alt="TB1N2nxbRr0gK0jSZFnXXbRRXXa 2448 1194"></div></div></div><br class="figure-break"><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_initialize_nacos_server" href="#_initialize_nacos_server"></a>4.2.1&nbsp;Initialize Nacos Server</h3></div></div></div><p>For specific startup methods, refer to the "Nacos Server Startup" section of the Spring Cloud Alibaba Nacos Discovery section.</p><p>After the Nacos Server is started, add how to configure it:</p><pre class="screen">Data ID:    nacos-config.properties

Group  :    DEFAULT_GROUP

Configuration format:    Properties

Configuration content:   user.name=nacos-config-properties
            user.age=90</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The default file extension of DataId is properties.</p></td></tr></table></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_usage_on_the_client" href="#_usage_on_the_client"></a>Usage on the Client</h4></div></div></div><p>If you want to use Nacos to manage externalized configurations for your applications, please use the starter with the group ID as <code class="literal">com.alibaba.cloud</code> and the artifact ID as <code class="literal">spring-cloud-starter-alibaba-nacos-config</code>.</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependency&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;groupId&gt;</span>com.alibaba.cloud<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/groupId&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;artifactId&gt;</span>spring-cloud-starter-alibaba-nacos-config<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/artifactId&gt;</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependency&gt;</span></pre><p>Now we can create a standard Spring Boot application.</p><pre class="programlisting"><xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@SpringBootApplication</xslthl:annotation>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span> NacosConfigApplication {

    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">static</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">void</span> main(String[] args) {
        ConfigurableApplicationContext applicationContext = SpringApplication.run(NacosConfigApplication.<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span>, args);
        String userName = applicationContext.getEnvironment().getProperty(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"user.name"</span>);
        String userAge = applicationContext.getEnvironment().getProperty(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"user.age"</span>);
        System.err.println(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"user name :"</span> +userName+<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"; age: "</span>+userAge);
    }
}</pre><p>Before running this example, we need to configure the address of the Nacos server in bootstrap.properties. For example:</p><p><b>bootstrap.properties.&nbsp;</b>
</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment"># DataId By default, the `spring.application.name` configuration is combined with the file extension (the configuration format uses properties by default), and the GROUP is not configured to use DEFAULT_GROUP by default. Therefore, the Nacos Config configuration corresponding to the configuration file has a DataId of nacos-config.properties and a GROUP of DEFAULT_GROUP</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.application.name</span>=nacos-config
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.nacos.config.server-addr</span>=127.0.0.1:8848</pre><p>
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>If you use domain name to access Nacos, the format of <code class="literal">spring.cloud.nacos.config.server-addr</code> should be <code class="literal">Domain name:port</code>.
For example, if the Nacos domain name is abc.com.nacos, and the listerner port is 80, then the configuration should be <code class="literal">spring.cloud.nacos.config.server-addr=abc.com.nacos:80</code>.
Port 80 cannot be omitted.</p></td></tr></table></div><p>Run this example and you can see the following output:</p><pre class="screen">2018-11-02 14:24:51.638  INFO 32700 --- [main] c.a.demo.provider.NacosConfigApplication    : Started NacosConfigApplication in 14.645 seconds (JVM running for 15.139)
user name :nacos-config-properties; age: 90
2018-11-02 14:24:51.688  INFO 32700 --- [-127.0.0.1:8848] s.c.a.AnnotationConfigApplicationContext : Refreshing org.springframework.context.annotation.AnnotationConfigApplicationContext@a8c5e74: startup date [Fri Nov 02 14:24:51 CST 2018]; root of context hierarchy</pre></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_add_configurations_with_dataid_in_yaml_format" href="#_add_configurations_with_dataid_in_yaml_format"></a>4.3&nbsp;Add Configurations with DataId in YAML Format</h2></div></div></div><p>Nacos Config supports yaml format as well. You only need to complete the following 2 steps.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">In the bootstrap.properties file, add the following line to claim that the format of DataId is yaml. As follows:</li></ol></div><p><b>bootstrap.properties.&nbsp;</b>
</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.nacos.config.file-extension</span>=yaml</pre><p>
</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">Add a configuration with the DataId in yaml format on the Nacos console, as shown below:</li></ol></div><pre class="screen">Data ID:        nacos-config.yaml

Group  :        DEFAULT_GROUP

Configuration format:        YAML

Configuration content:        user.name: nacos-config-yaml
                              user.age: 68</pre><p>After completing the preivous two steps, restart the testing program and you will see the following result.</p><pre class="screen">2018-11-02 14:59:00.484  INFO 32928 --- [main] c.a.demo.provider.NacosConfigApplication:Started NacosConfigApplication in 14.183 seconds (JVM running for 14.671)
user name :nacos-config-yaml; age: 68
2018-11-02 14:59:00.529  INFO 32928 --- [-127.0.0.1:8848] s.c.a.AnnotationConfigApplicationContext : Refreshing org.springframework.context.annotation.AnnotationConfigApplicationContext@265a478e: startup date [Fri Nov 02 14:59:00 CST 2018]; root of context hierarchy</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_support_dynamic_configuration_udpates" href="#_support_dynamic_configuration_udpates"></a>4.4&nbsp;Support Dynamic Configuration Udpates</h2></div></div></div><p>Nacos Config also supports dynamic configuration updates. The code for starting Spring Boot application testing is as follows:</p><pre class="programlisting"><xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@SpringBootApplication</xslthl:annotation>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span> NacosConfigApplication {

    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">static</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">void</span> main(String[] args) {
        ConfigurableApplicationContext applicationContext = SpringApplication.run(NacosConfigApplication.<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span>, args);
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">while</span>(true) {
            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment">//When configurations are refreshed dynamically, they will be updated in the Enviroment, therefore here we retrieve configurations from Environment every other second.</span>
            String userName = applicationContext.getEnvironment().getProperty(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"user.name"</span>);
            String userAge = applicationContext.getEnvironment().getProperty(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"user.age"</span>);
            System.err.println(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"user name :"</span> + userName + <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"; age: "</span> + userAge);
            TimeUnit.SECONDS.sleep(<xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">1</xslthl:number>);
        }
    }
}</pre><p>When user.name is changed, the latest value can be retrieved from the application, as shown below:</p><pre class="screen">user name :nacos-config-yaml; age: 68
user name :nacos-config-yaml; age: 68
user name :nacos-config-yaml; age: 68
2018-11-02 15:04:25.069  INFO 32957 --- [-127.0.0.1:8848] o.s.boot.SpringApplication               : Started application in 0.144 seconds (JVM running for 71.752)
2018-11-02 15:04:25.070  INFO 32957 --- [-127.0.0.1:8848] s.c.a.AnnotationConfigApplicationContext : Closing org.springframework.context.annotation.AnnotationConfigApplicationContext@10c89124: startup date [Fri Nov 02 15:04:25 CST 2018]; parent: org.springframework.context.annotation.AnnotationConfigApplicationContext@6520af7
2018-11-02 15:04:25.071  INFO 32957 --- [-127.0.0.1:8848] s.c.a.AnnotationConfigApplicationContext : Closing org.springframework.context.annotation.AnnotationConfigApplicationContext@6520af7: startup date [Fri Nov 02 15:04:24 CST 2018]; root of context hierarchy
//Read the updated value from Enviroment
user name :nacos-config-yaml-update; age: 68
user name :nacos-config-yaml-update; age: 68</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>You can disable automatic refresh with this setting`spring.cloud.nacos.config.refresh.enabled=false`.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_support_configurations_at_the_profile_level" href="#_support_configurations_at_the_profile_level"></a>4.5&nbsp;Support configurations at the profile level</h2></div></div></div><p>When configurations are loaded by Nacos Config, basic configurations with  DataId of <code class="literal">${spring.application.name}. ${file-extension:properties}</code> , and DataId of <code class="literal">${spring.application.name}-${profile}. ${file-extension:properties}</code> are also loaded. If you need to use different configurations from different environments, you can use the <code class="literal">${spring.profiles.active}</code> configuration provided by Spring.</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.profiles.active</span>=develop</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>When specified in configuration files, ${spring.profiles.active} must be placed in bootstrap.properties.</p></td></tr></table></div><p>Add a basic configuration in Nacos, with a DataId of nacos-config-develop.yaml, as shown below:</p><pre class="screen">Data ID:        nacos-config-develop.yaml

Group  :        DEFAULT_GROUP

Configuration format:        YAML

Configuration content:        current.env: develop-env</pre><p>Run the following Spring Boot application testing code:</p><pre class="programlisting"><xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@SpringBootApplication</xslthl:annotation>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span> NacosConfigApplication {

    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">static</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">void</span> main(String[] args) {
        ConfigurableApplicationContext applicationContext = SpringApplication.run(NacosConfigApplication.<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span>, args);
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">while</span>(true) {
            String userName = applicationContext.getEnvironment().getProperty(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"user.name"</span>);
            String userAge = applicationContext.getEnvironment().getProperty(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"user.age"</span>);
            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment">//Get the current deployment environment</span>
            String currentEnv = applicationContext.getEnvironment().getProperty(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"current.env"</span>);
            System.err.println(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"in "</span>+currentEnv+<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">" enviroment; "</span>+<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"user name :"</span> + userName + <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"; age: "</span> + userAge);
            TimeUnit.SECONDS.sleep(<xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">1</xslthl:number>);
        }
    }
}</pre><p>After started, you can see the output as follows in the console:</p><pre class="screen">in develop-env enviroment; user name :nacos-config-yaml-update; age: 68
2018-11-02 15:34:25.013  INFO 33014 --- [ Thread-11] ConfigServletWebServerApplicationContext : Closing org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@6f1c29b7: startup date [Fri Nov 02 15:33:57 CST 2018]; parent: org.springframework.context.annotation.AnnotationConfigApplicationContext@63355449</pre><p>To switch to the production environment, you only need to change the parameter of <code class="literal">${spring.profiles.active}</code>. As show below:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.profiles.active</span>=product</pre><p>At the same time, add the basic configuration with the DataId in the  Nacos of your production environment. For example, you can add the configuration with the DataId of nacos-config-product.yaml in Nacos of your production environment:</p><pre class="screen">Data ID:        nacos-config-product.yaml

Group  :        DEFAULT_GROUP

Configuration format:        YAML

Configuration content:        current.env: product-env</pre><p>Start the testing program and you will see the following result:</p><pre class="screen">in product-env enviroment; user name :nacos-config-yaml-update; age: 68
2018-11-02 15:42:14.628  INFO 33024 --- [Thread-11] ConfigServletWebServerApplicationContext : Closing org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@6aa8e115: startup date [Fri Nov 02 15:42:03 CST 2018]; parent: org.springframework.context.annotation.AnnotationConfigApplicationContext@19bb07ed</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>In this example, we coded the configuration in the configuration file by using the <code class="literal">spring.profiles.active=&lt;profilename&gt;</code> method. In real scenarios, this variable needs to be different in different environment. You can use the <code class="literal">-Dspring.profiles.active=&lt;profile&gt;</code> parameter to specify the configuration so that you can switch between different environments easily.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_support_custom_namespaces" href="#_support_custom_namespaces"></a>4.6&nbsp;Support Custom Namespaces</h2></div></div></div><p>For details about namespaces in Nacos, refer to <a class="link" href="https://nacos.io/zh-cn/docs/concepts.html" target="_top">Nacos Concepts</a></p><div class="blockquote"><blockquote class="blockquote"><p>Namespaces are used to isolate configurations for different tenants. Groups and Data IDs can be the same across different namespaces. Typical scenarios of namespaces is the isolation of configurations for different environments, for example, isolation between development/testing environments and production environments(configurations and services and so on).</p></blockquote></div><p>The &#8220;Public&#8221; namespace of Nacos is used if no namespace is specified in <code class="literal">${spring.cloud.nacos.config.namespace}</code>. You can also specify a custom namespace in the following way&#65306;</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.nacos.config.namespace</span>=b3404bc0-d7dc-4855-b519-570ed34b62d7</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>This configuration must be in the bootstrap.properties file. The value of <code class="literal">spring.cloud.nacos.config.namespace</code> is the id of the namespace, and the value of id can be retrieved from the Nacos console. Do not select other namespaces when adding configurations. Otherwise configurations cannot be retrieved properly.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_support_custom_groups" href="#_support_custom_groups"></a>4.7&nbsp;Support Custom Groups</h2></div></div></div><p>DEFAULT_GROUP is used by default when no <code class="literal">{spring.cloud.nacos.config.group}</code> configuration is defined. If you need to define your own group, you can define it in the following property:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.nacos.config.group</span>=DEVELOP_GROUP</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>This configuration must be in the bootstrap.properties file, and the value of Group must be the same with the value of <code class="literal">spring.cloud.nacos.config.group</code>.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_support_custom_data_id" href="#_support_custom_data_id"></a>4.8&nbsp;Support Custom Data Id</h2></div></div></div><p>As of Spring Cloud Alibaba Nacos Config, data id can be self-defined. For detailed design of this part, refer to <a class="link" href="https://github.com/spring-cloud-incubator/spring-cloud-alibaba/issues/141" target="_top">Github issue</a>.
The following is a complete sample:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.application.name</span>=opensource-service-provider
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.nacos.config.server-addr</span>=127.0.0.1:8848

<span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment"># config external configuration</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment"># 1. Data Id is in the default group of DEFAULT_GROUP, and dynamic refresh of configurations is not supported.</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.nacos.config.ext-config[0].data-id</span>=ext-config-common01.properties

<span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment"># 2. Data Id is not in the default group, and dynamic refresh of configurations is not supported.</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.nacos.config.ext-config[1].data-id</span>=ext-config-common02.properties
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.nacos.config.ext-config[1].group</span>=GLOBALE_GROUP

<span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment"># 3. Data Id is not in the default group and dynamic referesh of configurations is supported.</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.nacos.config.ext-config[2].data-id</span>=ext-config-common03.properties
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.nacos.config.ext-config[2].group</span>=REFRESH_GROUP
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.nacos.config.ext-config[2].refresh</span>=true</pre><p>We can see that:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Support multiple data ids by configuring <code class="literal">spring.cloud.nacos.config.ext-config[n].data-id</code>.</li><li class="listitem">Customize the group of data id by configuring <code class="literal">spring.cloud.nacos.config.ext-config[n].group</code>. If not specified,  DEFAULT_GROUP is used.</li><li class="listitem">Control whether this data id supports dynamic refresh of configurations is supported when configurations are changed by configuring <code class="literal">spring.cloud.nacos.config.ext-config[n].refresh</code>.
It&#8217;s not supported by default.</li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>When multiple Data Ids are configured at the same time, the priority is defined by the value of &#8220;n&#8221; in <code class="literal">spring.cloud.nacos.config.ext-config[n].data-id</code>. The bigger the value, the higher the priority.</p></td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The value of <code class="literal">spring.cloud.nacos.config.ext-config[n].data-id</code> must have a file extension, and it could be properties or yaml/yml.
The setting in <code class="literal">spring.cloud.nacos.config.file-extension</code> does not have any impact on the custom Data Id file extension.</p></td></tr></table></div><p>The configuration of custom Data Id allows the sharing of configurations among multiple applications, and also enables support of multiple configurations for one application.</p><p>To share the data id among multiple applications in a clearer manner, you can also use the following method:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.nacos.config.shared-dataids</span>=bootstrap-common.properties,all-common.properties
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.nacos.config.refreshable-dataids</span>=bootstrap-common.properties</pre><p>We can see that:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Multiple shared data ids can be configured using <code class="literal">spring.cloud.nacos.config.shared-dataids</code> , and the data ids are separted by commas.</li><li class="listitem"><code class="literal">spring.cloud.nacos.config.refreshable-dataids</code> is used to control which data ids will be refreshed dynamically when configurations are updated, and that the latest configuration values can be retrieved by applications. Data ids are separated with commas.
If not specified, all shared data ids will not be dynamically refreshed.</li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>When using <code class="literal">spring.cloud.nacos.config.shared-dataids</code> to configure multiple shared data ids,
we agree on the following priority between the shared configurations: Priorities are decided based on the order in which the configurations appear. The one that occurs later is higher in priority than the one that appears first.</p></td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>When using <code class="literal">spring.cloud.nacos.config.shared-dataids</code>, the data Id must have a file extension, and it could be properties or yaml/yml.
And the configuration in <code class="literal">spring.cloud.nacos.config.file-extension</code> does not have any impact on the customized Data Id file extension.</p></td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>When <code class="literal">spring.cloud.nacos.config.refreshable-dataids</code> specifies the data ids that support dynamic refresh, the corresponding values of the data ids should also specify file extensions.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_nacos_config_endpoint" href="#_nacos_config_endpoint"></a>4.9&nbsp;Nacos Config Endpoint</h2></div></div></div><p>Nacos Config provides an Endpoint internally with a corresponding endpoint id of <code class="literal">nacos-config</code>.</p><p>Endpoint exposed json contains three properties:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">Sources: Current application configuration data information</li><li class="listitem">RefreshHistory: Configuration refresh history</li><li class="listitem">NacosConfigProperties: Shows the current basic Nacos configurations of the current service</li></ol></div><p>The followings shows how a service instance accesses the Endpoint:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">{</span>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"NacosConfigProperties"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">{</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"serverAddr"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"127.0.0.1:8848"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"encode"</span>: null<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"group"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"DEFAULT_GROUP"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"prefix"</span>: null<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"fileExtension"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"properties"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"timeout"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">3000</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"endpoint"</span>: null<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"namespace"</span>: null<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"accessKey"</span>: null<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"secretKey"</span>: null<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"contextPath"</span>: null<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"clusterName"</span>: null<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"name"</span>: null<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"sharedDataids"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"base-common.properties,common.properties"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"refreshableDataids"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"common.properties"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"extConfig"</span>: null
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">},</span>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"RefreshHistory"</span>: [<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">{</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"timestamp"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"2019-07-29 11:20:04"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"dataId"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"nacos-config-example.properties"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"md5"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"7d5d7f1051ff6571e2ec9f90887d9d91"</span>
	}]<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"Sources"</span>: [<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">{</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"lastSynced"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"2019-07-29 11:19:04"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"dataId"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"common.properties"</span>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">},</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">{</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"lastSynced"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"2019-07-29 11:19:04"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"dataId"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"base-common.properties"</span>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">},</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">{</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"lastSynced"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"2019-07-29 11:19:04"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"dataId"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"nacos-config-example.properties"</span>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">}]</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">}</span></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_disable_nacos_config_autoconfiguration" href="#_disable_nacos_config_autoconfiguration"></a>4.10&nbsp;Disable Nacos Config AutoConfiguration</h2></div></div></div><p>set spring.cloud.nacos.config.enabled = false to disable Spring Cloud Nacos Config AutoConfiguration.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_more_information_about_nacos_config_starter_configurations" href="#_more_information_about_nacos_config_starter_configurations"></a>4.11&nbsp;More Information about Nacos Config Starter Configurations</h2></div></div></div><p>The following shows the other configurations of the starter of Nacos Config:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; " width="60%"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"><col class="col_4"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="top">Configuration</th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="top">Key</th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="top">Default Value</th><th style="border-bottom: 0.5pt solid ; " align="center" valign="top">Description</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Server address</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.config.server-addr</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>IP and port of the Nacos Server listener</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Dataid from nacos config</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.config.name</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>First take the prefix, then go to the name, and finally take spring.application.name</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Dataid from nacos config</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.config.prefix</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>First take the prefix, then go to the name, and finally take spring.application.name</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Encode for nacos config content</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.config.encode</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Encode for nacos config content</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>GROUP for nacos config</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.config.group</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">DEFAULT_GROUP</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>GROUP for nacos config</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>The suffix of nacos config dataId, also the file extension of config content.</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.config.fileExtension</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">properties</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>The suffix of nacos config dataId, also the file extension of config content(now support properties or yaml(yml))</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Timeout for get config from nacos</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.config.timeout</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">3000</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Timeout for get config from nacos</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Endpoint</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.config.endpoint</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Endpoint</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Namespace</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.config.namespace</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Namespace</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>AccessKey</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.config.accessKey</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Alibaba Cloud account accesskey</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>SecretKey</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.config.secretKey</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Alibaba Cloud account secretkey</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>The context path of Nacos Server</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.config.contextPath</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>The context path of Nacos Server</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Cluster name</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.config.clusterName</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Cluster name</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Dataid for Shared Configuration</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.config.sharedDataids</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Dataid for Shared Configuration, split by ","</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Dynamic refresh dataid for Shared Configuration</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.config.refreshableDataids</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Dynamic refresh dataid for Shared Configuration, split by ","</p></td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>custom dataid</p></td><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.nacos.config.extConfig</code></p></td><td style="border-right: 0.5pt solid ; " align="left" valign="top">&nbsp;</td><td style="" align="left" valign="top"><p>It&#8217;s a List&#65292;build up by <code class="literal">Config</code> POJO. <code class="literal">Config</code> has 3 attributes, <code class="literal">dataId</code>, <code class="literal">group</code> and <code class="literal">refresh</code></p></td></tr></tbody></table></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="_spring_cloud_alibaba_sentinel" href="#_spring_cloud_alibaba_sentinel"></a>5.&nbsp;Spring Cloud Alibaba Sentinel</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_introduction_of_sentinel" href="#_introduction_of_sentinel"></a>5.1&nbsp;Introduction of Sentinel</h2></div></div></div><p>As microservices become popular, the stability of service calls is becoming increasingly important. <a class="link" href="https://github.com/alibaba/Sentinel" target="_top">Sentinel</a> takes "flow" as the breakthrough point, and works on multiple fields including flow control, circuit breaking and load protection to protect service reliability.</p><p><a class="link" href="https://github.com/alibaba/Sentinel" target="_top">Sentinel</a> has the following features:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><span class="strong"><strong>Rich Scenarios</strong></span>&#65306; Sentinel has supported the key scenarios of Alibaba&#8217;s Double 11 Shopping Festivals for over 10 years, such as second kill(i.e., controlling sudden bursts of traffic flow so that it&#8217;s within the acceptable range of the system capacity), message load shifting, circuit breaking of unreliable downstream applications.</li><li class="listitem"><span class="strong"><strong>Comprehensive Real-Time Monitoring</strong></span>&#65306; Sentinel provides real-time monitoring capability. You can see the monitoring data of your servers at the accuracy of seconds, and even the overall runtime status of a cluster with less than 500 nodes.</li><li class="listitem"><span class="strong"><strong>Extensive Open-Source Ecosystem</strong></span>&#65306; Sentinel provides out-of-box modules that can be easily integrated with other open-source frameworks/libraries, such as Spring Cloud, Dubbo, and gRPC. To use Sentinel, you only need to introduce the related dependency and make a few simple configurations.</li><li class="listitem"><span class="strong"><strong>Sound SPI Extensions</strong></span>&#65306; Sentinel provides easy-to-use and sound SPI extension interfaces. You can customize logics with the SPI extensions quickly, for example, you can define your own rule management, or adapt to specific data sources.</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_how_to_use_sentinel" href="#_how_to_use_sentinel"></a>5.2&nbsp;How to Use Sentinel</h2></div></div></div><p>If you want to use Sentinel in your project, please use the starter with the group ID as <code class="literal">com.alibaba.cloud</code> and the artifact ID as <code class="literal">spring-cloud-starter-alibaba-sentinel</code>.</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependency&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;groupId&gt;</span>com.alibaba.cloud<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/groupId&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;artifactId&gt;</span>spring-cloud-starter-alibaba-sentinel<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/artifactId&gt;</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependency&gt;</span></pre><p>The following is a simple example of how to use Sentinel:</p><pre class="programlisting"><xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@SpringBootApplication</xslthl:annotation>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span> Application {

    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">static</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">void</span> main(String[] args) {
        SpringApplication.run(ServiceApplication.<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span>, args);
    }

}

<xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@RestController</xslthl:annotation>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span> TestController {

    <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@GetMapping(value = "/hello")</xslthl:annotation>
    <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@SentinelResource("hello")</xslthl:annotation>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> String hello() {
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">return</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"Hello Sentinel"</span>;
    }

}</pre><p>The @SentinelResource annotation is used to identify if a resource is rate limited or degraded. In the above sample, the 'hello' attribute of the annotation refers to the resource name.</p><p>@SentinelResource also provides attributes such as <code class="literal">blockHandler</code>, <code class="literal">blockHandlerClass</code>,  and <code class="literal">fallback</code> to identify rate limiting or degradation operations. For more details, refer to  <a class="link" href="https://github.com/alibaba/Sentinel/wiki/%E6%B3%A8%E8%A7%A3%E6%94%AF%E6%8C%81" target="_top">Sentinel Annotation Support</a>.</p><p>The above examples are all used in the WebServlet environment. Sentinel currently supports WebFlux and needs to cooperate with the <code class="literal">spring-boot-starter-webflux</code> dependency to trigger the WebFlux-related automation configuration in sentinel starter.</p><pre class="programlisting"><xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@SpringBootApplication</xslthl:annotation>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span> Application {

    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">static</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">void</span> main(String[] args) {
        SpringApplication.run(ServiceApplication.<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span>, args);
    }

}

<xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@RestController</xslthl:annotation>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span> TestController {

    <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@GetMapping("/mono")</xslthl:annotation>
    <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@SentinelResource("hello")</xslthl:annotation>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> Mono&lt;String&gt; mono() {
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">return</span> Mono.just(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"simple string"</span>)
			.transform(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">new</span> SentinelReactorTransformer&lt;&gt;(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"otherResourceName"</span>));
    }

}</pre><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_sentinel_dashboard" href="#_sentinel_dashboard"></a>5.2.1&nbsp;Sentinel Dashboard</h3></div></div></div><p>Sentinel dashboard is a lightweight console that provides functions such as machine discovery, single-server resource monitoring, overview of cluster resource data, as well as rule management. To use these features, you only need to complete a few steps.</p><p><span class="strong"><strong>Note</strong></span>: The statistics overview for clusters only supports clusters with less than 500 nodes, and has a latency of about 1 to 2 seconds.</p><div class="figure"><a name="d0e1115" href="#d0e1115"></a><p class="title"><b>Figure&nbsp;5.1.&nbsp;Sentinel Dashboard</b></p><div class="figure-contents"><div class="mediaobject"><img src="https://github.com/alibaba/Sentinel/wiki/image/dashboard.png" alt="dashboard"></div></div></div><br class="figure-break"><p>To use the Sentinel dashboard, simply complete the following 3 steps.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_get_the_dashboard" href="#_get_the_dashboard"></a>Get the Dashboard</h4></div></div></div><p>You can download the latest dashboard JAR file from the <a class="link" href="https://github.com/alibaba/Sentinel/releases" target="_top">Release Page</a>.</p><p>You can also get the latest source code to build your own Sentinel dashboard&#65306;</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Download the  <a class="link" href="https://github.com/alibaba/Sentinel/tree/master/sentinel-dashboard" target="_top">Dashboard</a> project.</li><li class="listitem">Run the following command to package the code into a FatJar: <code class="literal">mvn clean package</code></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_start_the_dashboard" href="#_start_the_dashboard"></a>Start the Dashboard</h4></div></div></div><p>Sentinel dashboard is a standard SpringBoot application, and you can run the JAR file in the Spring Boot mode.</p><pre class="programlisting">java -Dserver.port=8080 -Dcsp.sentinel.dashboard.server=localhost:8080 -Dproject.name=sentinel-dashboard -jar sentinel-dashboard.jar</pre><p>If there is conflict with the 8080 port, you can use <code class="literal">-Dserver.port=new port</code> to define a new port.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_configure_the_dashboard" href="#_configure_the_dashboard"></a>5.2.2&nbsp;Configure the Dashboard</h3></div></div></div><p><b>application.yml.&nbsp;</b>
</p><pre class="screen">spring:
  cloud:
    sentinel:
      transport:
        port: 8719
        dashboard: localhost:8080</pre><p>
</p><p>The port number specified in <code class="literal">spring.cloud.sentinel.transport.port</code> will start an HTTP Server on the corresponding server of the application, and this server will interact with the Sentinel dashboard. For example, if a rate limiting rule is added in the Sentinel dashboard, the the rule data will be pushed to and recieved by the HTTP Server, which in turn registers the rule to Sentinel.</p><p>For more information about Sentinel dashboard, please refer to <a class="link" href="https://github.com/alibaba/Sentinel/wiki/%E6%8E%A7%E5%88%B6%E5%8F%B0" target="_top">Sentinel Dashboard</a>.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_openfeign_support" href="#_openfeign_support"></a>5.3&nbsp;OpenFeign Support</h2></div></div></div><p>Sentinel is compatible with the <a class="link" href="https://github.com/OpenFeign/feign" target="_top">OpenFeign</a> component. To use it, in addition to introducing the <code class="literal">sentinel-starter</code> dependency, complete the following 2 steps:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Enable the Sentinel support for feign in the properties file. <code class="literal">feign.sentinel.enabled=true</code></li><li class="listitem">Add the <code class="literal">openfeign starter</code> dependency to trigger and enable <code class="literal">sentinel starter</code>:</li></ul></div><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependency&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;groupId&gt;</span>org.springframework.cloud<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/groupId&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;artifactId&gt;</span>spring-cloud-starter-openfeign<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/artifactId&gt;</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependency&gt;</span></pre><p>This is a simple usage of <code class="literal">FeignClient</code>:</p><pre class="programlisting"><xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@FeignClient(name = "service-provider", fallback = EchoServiceFallback.class, configuration = FeignConfiguration.class)</xslthl:annotation>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">interface</span> EchoService {
    <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@RequestMapping(value = "/echo/{str}", method = RequestMethod.GET)</xslthl:annotation>
    String echo(<xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@PathVariable("str")</xslthl:annotation> String str);
}

<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span> FeignConfiguration {
    <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Bean</xslthl:annotation>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> EchoServiceFallback echoServiceFallback() {
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">return</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">new</span> EchoServiceFallback();
    }
}

<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span> EchoServiceFallback <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">implements</span> EchoService {
    <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Override</xslthl:annotation>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> String echo(<xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@PathVariable("str")</xslthl:annotation> String str) {
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">return</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"echo fallback"</span>;
    }
}</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The resource name policy in the corresponding interface of Feign is&#65306;httpmethod:protocol://requesturl. All the attributes in the <code class="literal">@FeignClient</code> annotation is supported by Sentinel.</p></td></tr></table></div><p>The corresponding resource name of the <code class="literal">echo</code> method in the <code class="literal">EchoService</code> interface is <code class="literal">GET:http://service-provider/echo/{str}</code>.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_resttemplate_support" href="#_resttemplate_support"></a>5.4&nbsp;RestTemplate Support</h2></div></div></div><p>Spring Cloud Alibaba Sentinel supports the protection of <code class="literal">RestTemplate</code> service calls using Sentinel. To do this, you need to add the <code class="literal">@SentinelRestTemplate</code> annotation when constructing the <code class="literal">RestTemplate</code> bean.</p><pre class="programlisting"><xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Bean</xslthl:annotation>
<xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@SentinelRestTemplate(blockHandler = "handleException", blockHandlerClass = ExceptionUtil.class)</xslthl:annotation>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> RestTemplate restTemplate() {
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">return</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">new</span> RestTemplate();
}</pre><p>The attribute of the <code class="literal">@SentinelRestTemplate</code> annotation support flow control(<code class="literal">blockHandler</code>, <code class="literal">blockHandlerClass</code>) and circuit breaking(<code class="literal">fallback</code>, <code class="literal">fallbackClass</code>).</p><p>==</p><p>The <code class="literal">blockHandler</code> or <code class="literal">fallback</code> is the static method of <code class="literal">blockHandlerClass</code> or <code class="literal">fallbackClass</code>.</p><p>The parameter and return value of method in <code class="literal">@SentinelRestTemplate</code> is same as <code class="literal">org.springframework.http.client.ClientHttpRequestInterceptor#interceptor</code>, but it has one more parameter <code class="literal">BlockException</code> to catch the exception by Sentinel.</p><p>The method signature of <code class="literal">handleException</code> in <code class="literal">ExceptionUtil</code> above should be like this:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span> ExceptionUtil {
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">static</span> ClientHttpResponse handleException(HttpRequest request, <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">byte</span>[] body, ClientHttpRequestExecution execution, BlockException exception) {
        ...
    }
}</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>When the application starts, it will check if the <code class="literal">@SentinelRestTemplate</code> annotation corresponding to the flow control or circuit breaking method exists, if it does not exist, it will throw an exception.</p></td></tr></table></div><p>The attribute of the <code class="literal">@SentinelRestTemplate</code> annotation is optional.</p><p>It will return <code class="literal">RestTemplate request block by sentinel</code> when you using <code class="literal">RestTemplate</code> blocked by Sentinel. You can override it by your own logic. We provide <code class="literal">SentinelClientHttpResponse</code> to handle the response.</p><p>Sentinel RestTemplate provides two granularities for resource rate limiting:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><code class="literal">httpmethod:schema://host:port/path</code>&#65306; Protocol, host, port and path</li><li class="listitem"><code class="literal">httpmethod:schema://host:port</code>&#65306; Protocol, host and port</li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Take Http GET <code class="literal"><a class="link" href="https://www.taobao.com/test" target="_top">https://www.taobao.com/test</a></code> as an example. The corresponding resource names have two levels of granularities, <code class="literal">GET:https://www.taobao.com</code> and <code class="literal">GET:https://www.taobao.com/test</code>.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_dynamic_data_source_support" href="#_dynamic_data_source_support"></a>5.5&nbsp;Dynamic Data Source Support</h2></div></div></div><p><code class="literal">SentinelProperties</code> provide <code class="literal">datasource</code> attribute to configure datasource.</p><p>For example, 4 data sources are configures&#65306;</p><pre class="screen">spring.cloud.sentinel.datasource.ds1.file.file=classpath: degraderule.json
spring.cloud.sentinel.datasource.ds1.file.rule-type=flow

#spring.cloud.sentinel.datasource.ds1.file.file=classpath: flowrule.json
#spring.cloud.sentinel.datasource.ds1.file.data-type=custom
#spring.cloud.sentinel.datasource.ds1.file.converter-class=JsonFlowRuleListConverter
#spring.cloud.sentinel.datasource.ds1.file.rule-type=flow

spring.cloud.sentinel.datasource.ds2.nacos.server-addr=localhost:8848
spring.cloud.sentinel.datasource.ds2.nacos.data-id=sentinel
spring.cloud.sentinel.datasource.ds2.nacos.group-id=DEFAULT_GROUP
spring.cloud.sentinel.datasource.ds2.nacos.data-type=json
spring.cloud.sentinel.datasource.ds2.nacos.rule-type=degrade

spring.cloud.sentinel.datasource.ds3.zk.path = /Sentinel-Demo/SYSTEM-CODE-DEMO-FLOW
spring.cloud.sentinel.datasource.ds3.zk.server-addr = localhost:2181
spring.cloud.sentinel.datasource.ds3.zk.rule-type=authority

spring.cloud.sentinel.datasource.ds4.apollo.namespace-name = application
spring.cloud.sentinel.datasource.ds4.apollo.flow-rules-key = sentinel
spring.cloud.sentinel.datasource.ds4.apollo.default-flow-rule-value = test
spring.cloud.sentinel.datasource.ds4.apollo.rule-type=param-flow</pre><p>This method follows the configuration of Spring Cloud Stream Binder. <code class="literal">TreeMap</code> is used for storage internally, and comparator is <code class="literal">String.CASE_INSENSITIVE_ORDER</code>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>d1, ds2, ds3, ds4 are the names of <code class="literal">ReadableDataSource</code>, and can be coded as you like. The <code class="literal">file</code>, <code class="literal">zk</code>, <code class="literal">nacos</code> , <code class="literal">apollo</code> refer to the specific data sources. The configurations following them are the specific configurations of these data sources respecitively.</p></td></tr></table></div><p>Every data source has 3 common configuration items: <code class="literal">data-type</code>, <code class="literal">converter-class</code> and <code class="literal">rule-type</code>.</p><p><code class="literal">data-type</code> refers to <code class="literal">Converter</code>. Spring Cloud Alibaba Sentinel provides two embedded values by default: <code class="literal">json</code> and <code class="literal">xml</code> (the default is json if not specified). If you do not want to use the embedded <code class="literal">json</code> or <code class="literal">xml</code> <code class="literal">Converter</code>, you can also fill in <code class="literal">custom</code> to indicate that you will define your own <code class="literal">Converter</code>, and then configure the <code class="literal">converter-class</code>. You need to specify the full path of the class for this configuration.</p><p><code class="literal">rule-type</code> refers to the rule type in datasource(<code class="literal">flow</code>&#65292;<code class="literal">degrade</code>&#65292;<code class="literal">authority</code>&#65292;<code class="literal">system</code>, <code class="literal">param-flow</code>, <code class="literal">gw-flow</code>, <code class="literal">gw-api-group</code>).</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>XML format is not supported by default. To make it effective, you need to add the  <code class="literal">jackson-dataformat-xml</code> dependency.</p></td></tr></table></div><p>To learn more about how dynamic data sources work in Sentinel, refer to <a class="link" href="https://github.com/alibaba/Sentinel/wiki/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%99%E6%89%A9%E5%B1%95" target="_top">Dynamic Rule Extension</a>.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_support_zuul" href="#_support_zuul"></a>5.6&nbsp;Support Zuul</h2></div></div></div><p><a class="link" href="https://github.com/alibaba/Sentinel/wiki/%E7%BD%91%E5%85%B3%E9%99%90%E6%B5%81" target="_top">&#21442;&#32771; Sentinel &#32593;&#20851;&#38480;&#27969;</a></p><p>If you want to use Sentinel Starter with Zuul, you need to add the <code class="literal">spring-cloud-alibaba-sentinel-gateway</code> dependency, and you need to add the <code class="literal">spring-cloud-starter-netflix-zuul</code> dependency to let Zuul AutoConfiguration class in the gateway module takes effect:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependency&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;groupId&gt;</span>com.alibaba.cloud<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/groupId&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;artifactId&gt;</span>spring-cloud-starter-alibaba-sentinel<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/artifactId&gt;</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependency&gt;</span>

<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependency&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;groupId&gt;</span>com.alibaba.cloud<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/groupId&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;artifactId&gt;</span>spring-cloud-alibaba-sentinel-gateway<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/artifactId&gt;</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependency&gt;</span>

<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependency&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;groupId&gt;</span>org.springframework.cloud<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/groupId&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;artifactId&gt;</span>spring-cloud-starter-netflix-zuul<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/artifactId&gt;</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependency&gt;</span></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_support_spring_cloud_gateway" href="#_support_spring_cloud_gateway"></a>5.7&nbsp;Support Spring Cloud Gateway</h2></div></div></div><p><a class="link" href="https://github.com/alibaba/Sentinel/wiki/%E7%BD%91%E5%85%B3%E9%99%90%E6%B5%81" target="_top">&#21442;&#32771; Sentinel &#32593;&#20851;&#38480;&#27969;</a></p><p>If you want to use Sentinel Starter with Spring Cloud Gateway, you need to add the <code class="literal">spring-cloud-alibaba-sentinel-gateway</code> dependency and add the <code class="literal">spring-cloud-starter-gateway</code> dependency to let Spring Cloud Gateway AutoConfiguration class in the module takes effect:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependency&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;groupId&gt;</span>com.alibaba.cloud<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/groupId&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;artifactId&gt;</span>spring-cloud-starter-alibaba-sentinel<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/artifactId&gt;</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependency&gt;</span>

<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependency&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;groupId&gt;</span>com.alibaba.cloud<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/groupId&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;artifactId&gt;</span>spring-cloud-alibaba-sentinel-gateway<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/artifactId&gt;</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependency&gt;</span>

<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependency&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;groupId&gt;</span>org.springframework.cloud<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/groupId&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;artifactId&gt;</span>spring-cloud-starter-gateway<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/artifactId&gt;</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependency&gt;</span></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_sentinel_endpoint" href="#_sentinel_endpoint"></a>5.8&nbsp;Sentinel Endpoint</h2></div></div></div><p>Sentinel provides an Endpoint internally with a corresponding endpoint id of <code class="literal">sentinel</code>.</p><p>Endpoint exposed json contains multi properties:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">appName: application name</li><li class="listitem">logDir: the directory of log</li><li class="listitem">logUsePid: log name with pid ot not</li><li class="listitem">blockPage: redirect page after sentinel block</li><li class="listitem">metricsFileSize: the size of metrics file</li><li class="listitem">metricsFileCharset: metrics file charset</li><li class="listitem">totalMetricsFileCount: the total file count of of metrics file</li><li class="listitem">consoleServer: sentinel dashboard address</li><li class="listitem">clientIp: client ip</li><li class="listitem">heartbeatIntervalMs: client heartbeat interval with dashboard</li><li class="listitem">clientPort: the client needs to expose the port to interact with the dashboard</li><li class="listitem">coldFactor: cold factor</li><li class="listitem">filter: CommonFilter related properties, such as order, urlPatterns and enable</li><li class="listitem">datasource: datasource configuration info by client</li><li class="listitem">rules: the rule that the client takes effect internally contains flowRules, degradeRules, systemRules, authorityRule, paramFlowRule</li></ol></div><p>The followings shows how a service instance accesses the Endpoint:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">{</span>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"blockPage"</span>: null<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"appName"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"sentinel-example"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"consoleServer"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"localhost:8080"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"coldFactor"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"3"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"rules"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">{</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"flowRules"</span>: [<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">{</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"resource"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"GET:http://www.taobao.com"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"limitApp"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"default"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"grade"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">1</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"count"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">0.0</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"strategy"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">0</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"refResource"</span>: null<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"controlBehavior"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">0</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"warmUpPeriodSec"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">10</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"maxQueueingTimeMs"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">500</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"clusterMode"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">false</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"clusterConfig"</span>: null
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">},</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">{</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"resource"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"/test"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"limitApp"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"default"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"grade"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">1</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"count"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">0.0</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"strategy"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">0</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"refResource"</span>: null<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"controlBehavior"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">0</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"warmUpPeriodSec"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">10</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"maxQueueingTimeMs"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">500</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"clusterMode"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">false</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"clusterConfig"</span>: null
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">},</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">{</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"resource"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"/hello"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"limitApp"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"default"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"grade"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">1</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"count"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">1.0</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"strategy"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">0</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"refResource"</span>: null<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"controlBehavior"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">0</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"warmUpPeriodSec"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">10</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"maxQueueingTimeMs"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">500</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"clusterMode"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">false</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"clusterConfig"</span>: null
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">}]</span>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">},</span>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"metricsFileCharset"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"UTF-8"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"filter"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">{</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"order"</span>: -<xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">2147483648</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"urlPatterns"</span>: [<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"/*"</span>]<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"enabled"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">true</span>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">},</span>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"totalMetricsFileCount"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">6</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"datasource"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">{</span>
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"ds1"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">{</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"file"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">{</span>
				<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"dataType"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"json"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
				<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"ruleType"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"FLOW"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
				<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"converterClass"</span>: null<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
				<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"file"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"..."</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
				<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"charset"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"utf-8"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
				<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"recommendRefreshMs"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">3000</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
				<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"bufSize"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">1048576</xslthl:number>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">},</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"nacos"</span>: null<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"zk"</span>: null<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"apollo"</span>: null<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
			<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"redis"</span>: null
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">}</span>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">},</span>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"clientIp"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"30.5.121.91"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"clientPort"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"8719"</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"logUsePid"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">false</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"metricsFileSize"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">52428800</xslthl:number><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"logDir"</span>: <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"..."</span><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">,</span>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"heartbeatIntervalMs"</span>: <xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">10000</xslthl:number>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">}</span></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_configuration" href="#_configuration"></a>5.9&nbsp;Configuration</h2></div></div></div><p>The following table shows that when there are corresponding bean types in <code class="literal">ApplicationContext</code>, some actions will be taken:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; " width="60%"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="top">Existing Bean Type</th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="top">Action</th><th style="border-bottom: 0.5pt solid ; " align="center" valign="top">Function</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">UrlCleaner</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">WebCallbackManager.setUrlCleaner(urlCleaner)</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Resource cleaning(resource(for example, classify all URLs of /foo/:id to the  /foo/* resource))</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">UrlBlockHandler</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">WebCallbackManager.setUrlBlockHandler(urlBlockHandler)</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Customize rate limiting logic</p></td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">RequestOriginParser</code></p></td><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">WebCallbackManager.setRequestOriginParser(requestOriginParser)</code></p></td><td style="" align="left" valign="top"><p>Setting the origin</p></td></tr></tbody></table></div><p>The following table shows all the configurations of Spring Cloud Alibaba Sentinel:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; " width="60%"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="top">Configuration</th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="top">Description</th><th style="border-bottom: 0.5pt solid ; " align="center" valign="top">Default Value</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.application.name</code> or <code class="literal">project.name</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Project Name Of Sentinel</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.sentinel.enabled</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Whether Sentinel automatic configuration takes effect</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>true</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.sentinel.eager</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Whether to trigger Sentinel initialization in advance</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>false</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.sentinel.transport.port</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Port for the application to interact with Sentinel dashboard. An HTTP Server which uses this port will be started in the application</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>8719</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.sentinel.transport.dashboard</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Sentinel dashboard address</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.sentinel.transport.heartbeatIntervalMs</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Hearbeat interval between the application and Sentinel dashboard</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.sentinel.transport.client-ip</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>The client IP of this configuration will be registered to the Sentinel Server side.</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.sentinel.filter.order</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Loading order of Servlet Filter. The filter will be constructed in the Starter</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Integer.MIN_VALUE</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.sentinel.filter.url-patterns</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Data type is array. Refers to the collection of Servlet Filter ULR patterns</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>/*</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.sentinel.filter.enabled</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Enable to instance CommonFilter</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>true</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.sentinel.metric.charset</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>metric file character set</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>UTF-8</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.sentinel.metric.fileSingleSize</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Sentinel metric single file size</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.sentinel.metric.fileTotalCount</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Sentinel metric total file number</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.sentinel.log.dir</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Directory of Sentinel log files</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.sentinel.log.switch-pid</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>If PID is required for Sentinel log file names</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>false</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.sentinel.servlet.blockPage</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Customized redirection URL. When rate limited, the request will be redirected to the pre-defined URL</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.sentinel.flow.coldFactor</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><a class="link" href="https://github.com/alibaba/Sentinel/wiki/%E9%99%90%E6%B5%81---%E5%86%B7%E5%90%AF%E5%8A%A8" target="_top">ColdFactor</a></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>3</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.sentinel.zuul.order.pre</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>The order of SentinelZuulPreFilter</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>10000</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.sentinel.zuul.order.post</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>The order of SentinelZuulPostFilter</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>1000</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.sentinel.zuul.order.error</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>The order of SentinelZuulErrorFilter</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>-1</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.sentinel.scg.fallback.mode</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Response mode after Spring Cloud Gateway circuit break (select <code class="literal">redirect</code> or <code class="literal">response</code>)</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.sentinel.scg.fallback.redirect</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Spring Cloud Gateway response mode is the redirect URL corresponding to 'redirect' mode</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.sentinel.scg.fallback.response-body</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Spring Cloud Gateway response mode is response content corresponding to 'response' mode</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">&nbsp;</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.sentinel.scg.fallback.response-status</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Spring Cloud Gateway response mode is the response code corresponding to 'response' mode</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>429</p></td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p><code class="literal">spring.cloud.sentinel.scg.fallback.content-type</code></p></td><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>The Spring Cloud Gateway response mode is the content-type corresponding to the 'response' mode.</p></td><td style="" align="left" valign="top"><p>application/json</p></td></tr></tbody></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>These configurations will only take effect in servlet environment. RestTemplate and Feign will not take effect for these configurations.</p></td></tr></table></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="_spring_cloud_alibaba_dubbo" href="#_spring_cloud_alibaba_dubbo"></a>6.&nbsp;Spring Cloud Alibaba Dubbo</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_introduction_2" href="#_introduction_2"></a>6.1&nbsp;Introduction</h2></div></div></div><p>Dubbo Spring Cloud is based on Dubbo Spring Boot 2.7.3[1] and Spring Cloud 2.x development, whether the developer is a Dubbo user or a Spring Cloud user.
Easily navigate and move apps up at a cost close to &#8220;zero&#8221; costs. Dubbo Spring Cloud is designed to simplify Cloud Native development costs, improve R&amp;D performance, and improve application performance.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_features" href="#_features"></a>6.2&nbsp;Features</h2></div></div></div><p>Since Dubbo Spring Cloud is built on top of the native Spring Cloud, its service governance capabilities are considered Spring Cloud Plus.
Not only does it fully cover the Spring Cloud native features [5], but it also provides a more stable and mature implementation, as shown in the following table:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; " width="60%"><colgroup><col class="col_1"><col class="col_2"><col class="col_3"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="top">Feature</th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="center" valign="top">Spring Cloud</th><th style="border-bottom: 0.5pt solid ; " align="center" valign="top">Dubbo Spring Cloud</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Distributed configuration</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Git&#12289;Zookeeper&#12289;Consul&#12289;JDBC</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Spring Cloud Distributed Configuration + Dubbo Configuration Center[6]</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Service registration and discovery</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Eureka&#12289;Zookeeper&#12289;Consul</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Spring Cloud Native Registration Center[7] + Dubbo Native Registration Center[8]</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Load balancing</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Ribbon&#65288;Random, RoundRobin&#65289;</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Dubbo built-in implementation (random, polling, etc. + weights, etc.)</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Circuit Breakers</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Spring Cloud Hystrix</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Spring Cloud Hystrix + Alibaba Sentinel[9] etc.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Service-to-service calls</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Open Feign&#12289;<code class="literal">RestTemplate</code></p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Spring Cloud service call + Dubbo <code class="literal">@Reference</code>.</p></td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>Tracing</p></td><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>Spring Cloud Sleuth[10] + Zipkin[11]</p></td><td style="" align="left" valign="top"><p>Zipkin&#12289;opentracing, etc.</p></td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_reference" href="#_reference"></a>6.3&nbsp;Reference</h2></div></div></div><p>[1]: Starting with 2.7.0, Dubbo Spring Boot and Dubbo are consistent in version</p><p>[2]: Preview releases of Spring Cloud Alibaba are available: 0.9.0, 0.2.2, and 0.1.2 - <a class="link" href="https://spring.io/blog/2011/04/11/preview-releases-of-spring-cloud-alibaba-are-available-0-9-0-0-2-2-and-0-1-2" target="_top">https://spring.io/blog/2011/04/11/preview-releases-of-spring-cloud-alibaba-are-available-0-9-0-0-2-2-and-0-1-2</a></p><p>[3]: The current version of the Spring Cloud "F" is: <code class="literal">Finchley.SR2</code> - <a class="link" href="https://cloud.spring.io/spring-cloud-static/Finchley.SR2/single/spring-cloud.html" target="_top">https://cloud.spring.io/spring-cloud-static/Finchley.SR2/single/spring-cloud.html</a></p><p>[4]: The current Spring Cloud "G" version is <code class="literal">Greenwich.RELEASE</code></p><p>[5]:  Spring Cloud feature list - <a class="link" href="https://cloud.spring.io/spring-cloud-static/Greenwich.RELEASE/single/spring-cloud.html#_features" target="_top">https://cloud.spring.io/spring-cloud-static/Greenwich.RELEASE/single/spring-cloud.html#_features</a></p><p>[6]:  Dubbo 2.7 starts supporting the configuration center and can be customized - <a class="link" href="http://dubbo.apache.org/en-us/docs/user/configuration/config-center.html" target="_top">http://dubbo.apache.org/en-us/docs/user/configuration/config-center.html</a></p><p>[7]: Spring Cloud native registry, in addition to Eureka, Zookeeper, and Consul, includes Nacos in Spring Cloud Alibaba</p><p>[8]: Dubbo Native Registration Center - <a class="link" href="http://dubbo.apache.org/en-us/docs/user/references/registry/introduction.html" target="_top">http://dubbo.apache.org/en-us/docs/user/references/registry/introduction.html</a></p><p>[9]: Alibaba Sentinel: Sentinel uses traffic as an entry point to protect service stability from multiple dimensions such as flow control, blowdown, and system load protection - <a class="link" href="https://github.com/alibaba/Sentinel/wiki/%E4%BB%8B" target="_top">https://github.com/alibaba/Sentinel/wiki/%E4%BB%8B</a> %E7%BB%8D, currently Sentinel has been accepted as a candidate for Circuit Breaker by the Spring Cloud project - <a class="link" href="https://spring.io/blog/2011/04/8/introducing-spring-cloud-circuit-breaker" target="_top">https://spring.io/blog/2011/04/8/introducing-spring-cloud-circuit-breaker</a></p><p>[10]:Spring Cloud Sleuth - <a class="link" href="https://spring.io/projects/spring-cloud-sleuth" target="_top">https://spring.io/projects/spring-cloud-sleuth</a></p><p>[11]: Zipkin - <a class="link" href="https://github.com/apache/incubator-zipkin" target="_top">https://github.com/apache/incubator-zipkin</a></p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="_spring_cloud_alibaba_rocketmq_binder" href="#_spring_cloud_alibaba_rocketmq_binder"></a>7.&nbsp;Spring Cloud Alibaba RocketMQ Binder</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_introduction_of_rocketmq" href="#_introduction_of_rocketmq"></a>7.1&nbsp;Introduction of RocketMQ</h2></div></div></div><p><a class="link" href="https://rocketmq.apache.org" target="_top">RocketMQ</a> is an open-source distributed message system. It is based on highly available distributed cluster technologies and provides message publishing and subscription service with low latency and high stability. RocketMQ is widely used in a variety of industries, such as decoupling of asynchronous communication, enterprise sulotions, financial settlements, telecommunication, e-commerce, logistics, marketing, social media, instant messaging, mobile applications, mobile games, vedios, IoT, and Internet of Vehicles.</p><p>It has the following features:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Strict order of message sending and consumption</li><li class="listitem">Rich modes of message pulling</li><li class="listitem">Horizontal scalability of consumers</li><li class="listitem">Real-time message subscription</li><li class="listitem">Billion-level message accumulation capability</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_rocketmq_usages" href="#_rocketmq_usages"></a>7.2&nbsp;RocketMQ Usages</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Download RocketMQ</li></ul></div><p>Download <a class="link" href="https://www.apache.org/dyn/closer.cgi?path=rocketmq/4.3.2/rocketmq-all-4.3.2-bin-release.zip" target="_top">Latest Binary File of RocketMQ</a>, and decompress it.</p><p>The decompressed directory is as follows:</p><pre class="screen">apache-rocketmq
&#9500;&#9472;&#9472; LICENSE
&#9500;&#9472;&#9472; NOTICE
&#9500;&#9472;&#9472; README.md
&#9500;&#9472;&#9472; benchmark
&#9500;&#9472;&#9472; bin
&#9500;&#9472;&#9472; conf
&#9492;&#9472;&#9472; lib</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Start NameServer</li></ul></div><pre class="programlisting">nohup sh bin/mqnamesrv &amp;
tail -f ~/logs/rocketmqlogs/namesrv.log</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Start Broker</li></ul></div><pre class="programlisting">nohup sh bin/mqbroker -n localhost:<xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">9876</xslthl:number> &amp;
tail -f ~/logs/rocketmqlogs/broker.log</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Send and Receive Messages</li></ul></div><p>Send messages:</p><pre class="programlisting">sh bin/tools.sh org.apache.rocketmq.example.quickstart.Producer</pre><p>Output when the message is successfuly sent: <code class="literal">SendResult [sendStatus=SEND_OK, msgId= &#8230;&#8203;</code></p><p>Receive messages:</p><pre class="programlisting">sh bin/tools.sh org.apache.rocketmq.example.quickstart.Consumer</pre><p>Output when the message is successfully received&#65306; <code class="literal">ConsumeMessageThread_%d Receive New Messages: [MessageExt&#8230;&#8203;</code></p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Disable Server</li></ul></div><pre class="programlisting">sh bin/mqshutdown broker
sh bin/mqshutdown namesrv</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_introduction_of_spring_cloud_stream" href="#_introduction_of_spring_cloud_stream"></a>7.3&nbsp;Introduction of Spring Cloud Stream</h2></div></div></div><p>Spring Cloud Stream is a microservice framework used to build architectures based on messages. It helps you to create production-ready single-server Spring applications based on SpringBoot, and connects with Broker using <code class="literal">Spring Integration</code>.</p><p>Spring Cloud Stream provides unified abstractions of message middleware configurations, and puts forward concepts such as publish-subscribe, consumer groups and partition.</p><p>There are two concepts in Spring Cloud Stream: Binder and Binding</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Binder: A component used to integrate with external message middleware, and is used to create binding. Different message middleware products have their own binder implementations.</li></ul></div><p>For example, <code class="literal">Kafka</code> uses <code class="literal">KafkaMessageChannelBinder</code>, <code class="literal">RabbitMQ</code> uses <code class="literal">RabbitMessageChannelBinder</code>, while <code class="literal">RocketMQ</code> uses <code class="literal">RocketMQMessageChannelBinder</code>.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Binding: Includes Input Binding and Output Binding.</li></ul></div><p>Binding serves as a bridge between message middleware and the provider and consumer of the applications. Developers only need to use the Provider or Consumer to produce or consume data, and do not need to worry about the interactions with the message middleware.</p><div class="figure"><a name="d0e2175" href="#d0e2175"></a><p class="title"><b>Figure&nbsp;7.1.&nbsp;Spring Cloud Stream</b></p><div class="figure-contents"><div class="mediaobject"><img src="https://docs.spring.io/spring-cloud-stream/docs/current/reference/htmlsingle/images/SCSt-overview.png" alt="SCSt overview"></div></div></div><br class="figure-break"><p>Now let&#8217;s use Spring Cloud Stream to write a simple code for sending and receiving messages:</p><pre class="programlisting">MessageChannel messageChannel = <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">new</span> DirectChannel();

<span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment">// Message subscription</span>
((SubscribableChannel) messageChannel).subscribe(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">new</span> MessageHandler() {
    <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Override</xslthl:annotation>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">void</span> handleMessage(Message&lt;? &gt; message) <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">throws</span> MessagingException {
        System.out.println(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"receive msg: "</span> + message.getPayload());
    }
});

<span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment">// Message sending</span>
messageChannel.send(MessageBuilder.withPayload(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"simple msg"</span>).build());</pre><p>All the message types in this code are provided by the `spring-messaging`module. It shields the lower-layer implementations of message middleware. If you would like to change the message middleware, you only need to configure the related message middleware information in the configuration file and modify the binder dependency.</p><p><span class="strong"><strong>The lower layer of Spring Cloud Stream also implements various code abstractions based on the previous code.</strong></span></p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_how_to_use_spring_cloud_alibaba_rocketmq_binder" href="#_how_to_use_spring_cloud_alibaba_rocketmq_binder"></a>7.4&nbsp;How to use Spring Cloud Alibaba RocketMQ Binder</h2></div></div></div><p>For using the Spring Cloud Alibaba RocketMQ Binder, you just need to add it to your Spring Cloud Stream application, using the following Maven coordinates:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependency&gt;</span>
  <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;groupId&gt;</span>com.alibaba.cloud<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/groupId&gt;</span>
  <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;artifactId&gt;</span>spring-cloud-stream-binder-rocketmq<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/artifactId&gt;</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependency&gt;</span></pre><p>Alternatively, you can also use the Spring Cloud Stream RocketMQ Starter:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependency&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;groupId&gt;</span>com.alibaba.cloud<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/groupId&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;artifactId&gt;</span>spring-cloud-starter-stream-rocketmq<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/artifactId&gt;</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependency&gt;</span></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_how_spring_cloud_alibaba_rocketmq_binder_works" href="#_how_spring_cloud_alibaba_rocketmq_binder_works"></a>7.5&nbsp;How Spring Cloud Alibaba RocketMQ Binder Works</h2></div></div></div><p>This is the implementation architecture of Spring Cloud Stream RocketMQ Binder:</p><div class="figure"><a name="d0e2209" href="#d0e2209"></a><p class="title"><b>Figure&nbsp;7.2.&nbsp;SCS RocketMQ Binder</b></p><div class="figure-contents"><div class="mediaobject"><img src="https://img.alicdn.com/tfs/TB1v8rcbUY1gK0jSZFCXXcwqXXa-1236-773.png" alt="TB1v8rcbUY1gK0jSZFCXXcwqXXa 1236 773"></div></div></div><br class="figure-break"><p>The implementation of RocketMQ Binder depend on the <a class="link" href="https://github.com/apache/rocketmq-spring" target="_top">RocketMQ-Spring</a> framework.</p><p>RocketMQ Spring framework is an integration of RocketMQ and Spring Boot. It provides three main features:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><code class="literal">RocketMQTemplate</code>: Sending messages, including synchronous, asynchronous, and transactional messages.</li><li class="listitem"><code class="literal">@RocketMQTransactionListener</code>: Listen and check for transaction messages.</li><li class="listitem"><code class="literal">@RocketMQMessageListener</code>: Consume messages.</li></ol></div><p><code class="literal">RocketMQMessageChannelBinder</code> is a standard implementation of Binder, it will build <code class="literal">RocketMQInboundChannelAdapter</code> and <code class="literal">RocketMQMessageHandler</code> internally.</p><p><code class="literal">RocketMQMessageHandler</code> will construct <code class="literal">RocketMQTemplate</code> based on the Binding configuration. <code class="literal">RocketMQTemplate</code> will convert the <code class="literal">org.springframework.messaging.Message</code> message class of <code class="literal">spring-messaging</code> module to the RocketMQ message class <code class="literal">org.apache.rocketmq.common .message.Message</code> internally, then send it out.</p><p><code class="literal">RocketMQInboundChannelAdapter</code> will also construct <code class="literal">RocketMQListenerBindingContainer</code> based on the Binding configuration, and <code class="literal">RocketMQListenerBindingContainer</code> will start the RocketMQ <code class="literal">Consumer</code> to receive the messages.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>RocketMQ Binder Application can also be used to configure rocketmq.** to trigger RocketMQ Spring related AutoConfiguration</p></td></tr></table></div><p>Currently Binder supports setting the relevant key in <code class="literal">Header</code> to set the properties of the RocketMQ message.</p><p>For example, <code class="literal">TAGS</code>, <code class="literal">DELAY</code>, <code class="literal">TRANSACTIONAL_ARG</code>, <code class="literal">KEYS</code>, <code class="literal">WAIT_STORE_MSG_OK</code>, <code class="literal">FLAG</code> represent the labels corresponding to the RocketMQ message.</p><pre class="programlisting">MessageBuilder builder = MessageBuilder.withPayload(msg)
    .setHeader(RocketMQHeaders.TAGS, <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"binder"</span>)
    .setHeader(RocketMQHeaders.KEYS, <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"my-key"</span>)
    .setHeader(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"DELAY"</span>, <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"1"</span>);
Message message = builder.build();
output().send(message);</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_support_messagesource" href="#_support_messagesource"></a>7.6&nbsp;Support MessageSource</h2></div></div></div><p>SCS RocketMQ Binder support <code class="literal">MessageSource</code>&#65292;which can receive messages by pull mode&#65306;</p><pre class="programlisting"><xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@SpringBootApplication</xslthl:annotation>
<xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@EnableBinding(MQApplication.PolledProcessor.class)</xslthl:annotation>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span> MQApplication {

  <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">private</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">final</span> Logger logger =
  	  LoggerFactory.getLogger(MQApplication.<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span>);

  <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">static</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">void</span> main(String[] args) {
    SpringApplication.run(MQApplication.<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span>, args);
  }

  <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Bean</xslthl:annotation>
  <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> ApplicationRunner runner(PollableMessageSource source,
  	    MessageChannel dest) {
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">return</span> args -&gt; {
      <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">while</span> (true) {
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">boolean</span> result = source.poll(m -&gt; {
          String payload = (String) m.getPayload();
          logger.info(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"Received: "</span> + payload);
          dest.send(MessageBuilder.withPayload(payload.toUpperCase())
              .copyHeaders(m.getHeaders())
              .build());
        }, <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">new</span> ParameterizedTypeReference&lt;String&gt;() { });
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">if</span> (result) {
          logger.info(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"Processed a message"</span>);
        }
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">else</span> {
          logger.info(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"Nothing to do"</span>);
        }
        Thread.sleep(<xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">5</xslthl:number>_<xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">000</xslthl:number>);
      }
    };
  }

  <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">static</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">interface</span> PolledProcessor {

    <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Input</xslthl:annotation>
    PollableMessageSource source();

    <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Output</xslthl:annotation>
    MessageChannel dest();

  }

}</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_configuration_options" href="#_configuration_options"></a>7.7&nbsp;Configuration Options</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_rocketmq_binder_properties" href="#_rocketmq_binder_properties"></a>7.7.1&nbsp;RocketMQ Binder Properties</h3></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">spring.cloud.stream.rocketmq.binder.name-server</span></dt><dd><p class="simpara">The name server of RocketMQ Server(Older versions use the namesrv-addr configuration item).</p><p class="simpara">Default: <code class="literal">127.0.0.1:9876</code>.</p></dd><dt><span class="term">spring.cloud.stream.rocketmq.binder.access-key</span></dt><dd><p class="simpara">The AccessKey of Alibaba Cloud Account.</p><p class="simpara">Default: null.</p></dd><dt><span class="term">spring.cloud.stream.rocketmq.binder.secret-key</span></dt><dd><p class="simpara">The SecretKey of Alibaba Cloud Account.</p><p class="simpara">Default: null.</p></dd><dt><span class="term">spring.cloud.stream.rocketmq.binder.enable-msg-trace</span></dt><dd><p class="simpara">Enable Message Trace feature for all producers and consumers.</p><p class="simpara">Default: <code class="literal">true</code>.</p></dd><dt><span class="term">spring.cloud.stream.rocketmq.binder.customized-trace-topic</span></dt><dd><p class="simpara">The trace topic for message trace.</p><p class="simpara">Default: <code class="literal">RMQ_SYS_TRACE_TOPIC</code>.</p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_rocketmq_consumer_properties" href="#_rocketmq_consumer_properties"></a>7.7.2&nbsp;RocketMQ Consumer Properties</h3></div></div></div><p>The following properties are available for RocketMQ producers only and must be prefixed with <code class="literal">spring.cloud.stream.rocketmq.bindings.&lt;channelName&gt;.consumer.</code>.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">enable</span></dt><dd><p class="simpara">Enable Consumer Binding.</p><p class="simpara">Default: <code class="literal">true</code>.</p></dd><dt><span class="term">tags</span></dt><dd><p class="simpara">Consumer subscription tags expression, tags split by <code class="literal">||</code>.</p><p class="simpara">Default: empty.</p></dd><dt><span class="term">sql</span></dt><dd><p class="simpara">Consumer subscription sql expression.</p><p class="simpara">Default: empty.</p></dd><dt><span class="term">broadcasting</span></dt><dd><p class="simpara">Control message mode, if you want all subscribers receive message all message, broadcasting is a good choice.</p><p class="simpara">Default: <code class="literal">false</code>.</p></dd><dt><span class="term">orderly</span></dt><dd><p class="simpara">Receiving message concurrently or orderly.</p><p class="simpara">Default: <code class="literal">false</code>.</p></dd><dt><span class="term">delayLevelWhenNextConsume</span></dt><dd><p class="simpara">Message consume retry strategy for concurrently consume:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">-1,no retry,put into DLQ directly</li><li class="listitem">0,broker control retry frequency</li><li class="listitem"><p class="simpara">&gt;0,client control retry frequency</p><p class="simpara">Default: <code class="literal">0</code>.</p></li></ul></div></dd><dt><span class="term">suspendCurrentQueueTimeMillis</span></dt><dd><p class="simpara">Time interval of message consume retry for orderly consume.</p><p class="simpara">Default: <code class="literal">1000</code>.</p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_rocketmq_provider_properties" href="#_rocketmq_provider_properties"></a>7.7.3&nbsp;RocketMQ Provider Properties</h3></div></div></div><p>The following properties are available for RocketMQ producers only and must be prefixed with <code class="literal">spring.cloud.stream.rocketmq.bindings.&lt;channelName&gt;.producer.</code>.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">enable</span></dt><dd><p class="simpara">Enable Producer Binding.</p><p class="simpara">Default: <code class="literal">true</code>.</p></dd><dt><span class="term">group</span></dt><dd><p class="simpara">Producer group name.</p><p class="simpara">Default: empty.</p></dd><dt><span class="term">maxMessageSize</span></dt><dd><p class="simpara">Maximum allowed message size in bytes.</p><p class="simpara">Default: <code class="literal">8249344</code>.</p></dd><dt><span class="term">transactional</span></dt><dd><p class="simpara">Send Transactional Message.</p><p class="simpara">Default: <code class="literal">false</code>.</p></dd><dt><span class="term">sync</span></dt><dd><p class="simpara">Send message in synchronous mode.</p><p class="simpara">Default: <code class="literal">false</code>.</p></dd><dt><span class="term">vipChannelEnabled</span></dt><dd><p class="simpara">Send message with vip channel.</p><p class="simpara">Default: <code class="literal">true</code>.</p></dd><dt><span class="term">sendMessageTimeout</span></dt><dd><p class="simpara">Millis of send message timeout.</p><p class="simpara">Default: <code class="literal">3000</code>.</p></dd><dt><span class="term">compressMessageBodyThreshold</span></dt><dd><p class="simpara">Compress message body threshold, namely, message body larger than 4k will be compressed on default.</p><p class="simpara">Default: <code class="literal">4096</code>.</p></dd><dt><span class="term">retryTimesWhenSendFailed</span></dt><dd><p class="simpara">Maximum number of retry to perform internally before claiming sending failure in synchronous mode.</p><p class="simpara">Default: <code class="literal">2</code>.</p></dd><dt><span class="term">retryTimesWhenSendAsyncFailed</span></dt><dd><p class="simpara">Maximum number of retry to perform internally before claiming sending failure in asynchronous mode.</p><p class="simpara">Default: <code class="literal">2</code>.</p></dd><dt><span class="term">retryNextServer</span></dt><dd><p class="simpara">Indicate whether to retry another broker on sending failure internally.</p><p class="simpara">Default: <code class="literal">false</code>.</p></dd></dl></div></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="_spring_cloud_alibaba_cloud_ans" href="#_spring_cloud_alibaba_cloud_ans"></a>8.&nbsp;Spring Cloud Alibaba Cloud ANS</h1></div></div></div><p>ANS(Application Naming Service) is a component of EDAS.  Spring Cloud Alibaba Cloud ANS provides the commercial version of service registration and discovery in conformity with the Spring Cloud specifications, so that you can develop your applications locally and run them on the cloud.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>EDAS currently supports direct deployment of Nacos Discovery applications</p></td></tr></table></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_how_to_introduce_spring_cloud_alibaba_cloud_ans" href="#_how_to_introduce_spring_cloud_alibaba_cloud_ans"></a>8.1&nbsp;How to Introduce Spring Cloud Alibaba Cloud ANS</h2></div></div></div><p>If you want to use ANS in your project, please use the starter with the group ID as <code class="literal">com.alibaba.cloud</code> and the artifact ID as <code class="literal">spring-cloud-starter-alicloud-ans</code>.</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependency&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;groupId&gt;</span>com.alibaba.cloud<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/groupId&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;artifactId&gt;</span>spring-cloud-starter-alicloud-ans<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/artifactId&gt;</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependency&gt;</span></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_use_ans_to_register_service" href="#_use_ans_to_register_service"></a>8.2&nbsp;Use ANS to Register Service</h2></div></div></div><p>When Spring Cloud AliCloud ANS Starter is introduced on the client, the metadata of the service such as IP, port number and weright will be registered to the registration center automatically. The client will maintain heartbeat with the server to prove that it is capable of providing service properly.</p><p>The following is a simple illustration.</p><pre class="programlisting"><xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@SpringBootApplication</xslthl:annotation>
<xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@EnableDiscoveryClient</xslthl:annotation>
<xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@RestController</xslthl:annotation>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span> ProviderApplication {

    <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@RequestMapping("/")</xslthl:annotation>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> String home() {
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">return</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"Hello world"</span>;
    }

    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">static</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">void</span> main(String[] args) {
        SpringApplication.run(ProviderApplication.<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span>, args);
    }

}</pre><p>As the service will registered to the registration center, we will need to configure the address of the registration center. We also need to add the following address in application.properties.</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment"># The application name will be used as the service name, therefore it is mandatory.</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.application.name</span>=ans-provider
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">server.port</span>=18081
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment"># The following is the IP and port number of the registration center.</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.ans.server-list</span>=127.0.0.1
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.ans.server-port</span>=8080</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>By now the registration center is not started yet, so you will get an error message if your application is started. Therefore, start the registration center before you start your application.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_start_registration_center" href="#_start_registration_center"></a>8.3&nbsp;Start Registration Center</h2></div></div></div><p>ANS uses two types of registration centers. One is the free lightweight configuration center and the other is the registration center on cloud, which is provided through EDAS. Generally, you can use the lightweight version for application development and local testing, and use EDAS for canary deployment or production.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_start_lightweight_configuration_center" href="#_start_lightweight_configuration_center"></a>8.3.1&nbsp;Start Lightweight Configuration Center</h3></div></div></div><p>Refer to the <a class="link" href="https://help.aliyun.com/document_detail/44163.html" target="_top">Configure Lightweight Configuration Center</a> for details about how to download and install lightweight configuration center.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>You only need to perform step 1(Download lightweight configuration center) and step 2(Start lightweight configuration center). Step 3(Configure hosts) is not required if you use ANS at the same time.</p></td></tr></table></div><p>After you start the lightweight configuration center, start ProviderApplication directly, and you will be able to register your service to the configuration center. The default port of the lightweight configuration center is 8080, therefore you can open <a class="link" href="http://127.0.0.1:8080" target="_top">http://127.0.0.1:8080</a>, click &#8220;Services&#8221; on the left and see the registered service.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_user_registration_center_on_the_cloud" href="#_user_registration_center_on_the_cloud"></a>8.3.2&nbsp;User Registration Center on the Cloud</h3></div></div></div><p>Using the registration center on the cloud saves you from the tedious work of server maintenance while at the same time provides a better stability. There is no difference at the code level between using the registration center on cloud and lightweight configuration center, but there are some differences in configurations.</p><p>The following is a simple sample of using the registration center on the cloud.</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment"># The application name will be used the service name, and is therefore mandatory.</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.application.name</span>=ans-provider
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment"># Configure your own port number</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">server.port</span>=18081
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment"># The following is the IP and port number of the configuration center. The default value is 127.0.0.1 and 8080, so the following lines can be omitted.</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.ans.server-mode</span>=EDAS
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.access-key</span>=Your Alibaba Cloud AK
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.secret-key</span>=Your Alibaba Cloud SK
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.edas.namespace</span>=cn-xxxxx</pre><p>The default value of server-mode is LOCAL. If you want to use the registration center on cloud, you need to change it to EDAS.</p><p>Access-key and secret-key are the AK/SK of your Alibaba Cloud account. Register an Alibaba Cloud account first and log on to the Cloud Console <a class="link" href="https://usercenter.console.aliyun.com/#/manage/ak" target="_top">Alibaba Cloud AK/SK</a>  to copy your AccessKey ID and Access Key Secret. If you haven&#8217;t created one, click the &#8220;Create AccessKey&#8221; button.</p><p>Namespace is a concept in EDAS, which is used to isolate environments, such as testing environment and production environment. To find your namespace, click to <a class="link" href="https://common-buy.aliyun.com/?spm=5176.11451019.0.0.6f5965c0Uq5tue&amp;commodityCode=edaspostpay#/buy" target="_top">Sign up for EDAS</a> first. You will not be charged under the pay-as-you-go mode. Then log on to the <a class="link" href="https://edas.console.aliyun.com/#/namespaces?regionNo=cn-hangzhou" target="_top">EDAS Console</a> and you will be able to see your namespace, for example cn-hangzhou.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>EDAS provides application hosting service and will fill in all configurations automatically for the hosted applications.</p></td></tr></table></div></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="_spring_cloud_alibaba_cloud_acm" href="#_spring_cloud_alibaba_cloud_acm"></a>9.&nbsp;Spring Cloud Alibaba Cloud ACM</h1></div></div></div><p>Spring Cloud AliCloud ACM is an implementation of the commercial product Application Configuration Management(ACM) in the client side of Spring Cloud, and is free of charge.</p><p>Use Spring Cloud AliCloud ACM to quickly access ACM configuration management capabilities based on Spring Cloud&#8217;s programming model.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Currently EDAS already supports direct deployment of the Nacos Config app.</p></td></tr></table></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_how_to_introduce_spring_cloud_alibaba_cloud_acm" href="#_how_to_introduce_spring_cloud_alibaba_cloud_acm"></a>9.1&nbsp;How to Introduce Spring Cloud Alibaba Cloud ACM</h2></div></div></div><p>If you want to use ACM in your project, please use the starter with the group ID as <code class="literal">com.alibaba.cloud</code> and the artifact ID as <code class="literal">spring-cloud-starter-alicloud-acm</code>.</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependency&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;groupId&gt;</span>com.alibaba.cloud<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/groupId&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;artifactId&gt;</span>spring-cloud-starter-alicloud-acm<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/artifactId&gt;</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependency&gt;</span></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_use_acm_to_manage_configurations" href="#_use_acm_to_manage_configurations"></a>9.2&nbsp;Use ACM to Manage Configurations</h2></div></div></div><p>When Spring Cloud Alibaba Cloud ACM Starter is introduced into the client, the application will automatically get configuration information from the configuration management server when it starts, and inject the configuration into Spring Environment.</p><p>The following is a simple illustration.</p><pre class="programlisting"><xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@SpringBootApplication</xslthl:annotation>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span> ProviderApplication {

    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">static</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">void</span> main(String[] args) {
        ConfigurableApplicationContext applicationContext = SpringApplication.run(ProviderApplication.<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span>, args);
        String userName = applicationContext.getEnvironment().getProperty(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"user.name"</span>);
        String userAge = applicationContext.getEnvironment().getProperty(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"user.age"</span>);
        System.err.println(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"user name :"</span> +userName+<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"; age: "</span>+userAge);
    }
}</pre><p>As we need to obtain configuration information from the configuration server, we will need to configure the address of the server. We also need to add the following information in bootstrap.properties.</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment"># Required. The application name will be used as part of the keyword to get the configuration key from the server.</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.application.name</span>=acm-config
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">server.port</span>=18081
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment"># The following is the IP and port number of the configuration server.</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.acm.server-list</span>=127.0.0.1
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.acm.server-port</span>=8080</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>By now the configuration center is not started yet, so you will get an error message if your application is started. Therefore, start the configuration center before you start your application.</p></td></tr></table></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_start_configuration_center" href="#_start_configuration_center"></a>9.2.1&nbsp;Start Configuration Center</h3></div></div></div><p>ACM uses two types of configuration centers. One is lightweight configuration center, the other is ACM which is used on Alibaba Cloud. Generally, you can use the lightweight version for application development and local testing, and use ACM for canary deployment or production.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_use_lightweight_configuration_center" href="#_use_lightweight_configuration_center"></a>Use Lightweight Configuration Center</h4></div></div></div><p>Refer to the <a class="link" href="https://help.aliyun.com/document_detail/44163.html" target="_top">Configure Lightweight Configuration Center</a> for details about how to download and install lightweight configuration center.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>You only need to perform step 1(Download lightweight configuration center) and step 2(Start lightweight configuration center).</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_use_acm_on_the_alibaba_cloud" href="#_use_acm_on_the_alibaba_cloud"></a>Use ACM on the Alibaba Cloud</h4></div></div></div><p>Using ACM on the cloud saves you from the tedious work of server maintenance while at the same time provides a better stability. There is no difference at the code level between using ACM on cloud and lightweight configuration center, but there are some differences in configurations.</p><p>The following is a simple sample of using ACM. You can view configuration details on <a class="link" href="https://acm.console.aliyun.com" target="_top">ACM Console</a></p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment"># The application name will be used as part of the keyword to obtain configuration key from the server, and is mandatory.</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.application.name</span>=acm-config
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment"># Configure your own port number</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">server.port</span>=18081
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment"># The following is the IP and port number of the configuration center.</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.acm.server-mode</span>=EDAS
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.access-key</span>=Your Alibaba Cloud AK
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.secret-key</span>=Your Alibaba Cloud SK
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.acm.endpoint</span>=acm.aliyun.com
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.acm.namespace</span>=Your ACM namespace(You can find the namespace on the ACM console)</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>EDAS provides application hosting service and will fill in all configurations about ACM automatically for the hosted applications.</p></td></tr></table></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_add_configuration_in_the_configuration_center" href="#_add_configuration_in_the_configuration_center"></a>9.2.2&nbsp;Add Configuration in the Configuration Center</h3></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">After you start the lightweight configuration center, add the following configuration on the console.</li></ol></div><pre class="screen">Group:      DEFAULT_GROOUP

DataId:     acm-config.properties

Content:    user.name=james
            user.age=18</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The format of dataId is <code class="literal">{prefix}. {file-extension}</code>. &#8220;prefix&#8221; is obtained from spring.application.name by default, and the value of &#8220;file-extension&#8221; is "properties&#8221; by default.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_start_application_verification" href="#_start_application_verification"></a>9.2.3&nbsp;Start Application Verification</h3></div></div></div><p>Start the following example and you can see that the value printed on the console is the value we configured in the lightweight configuration center.</p><pre class="screen">user name :james; age: 18</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_modify_configuration_file_extension" href="#_modify_configuration_file_extension"></a>9.3&nbsp;Modify Configuration File Extension</h2></div></div></div><p>The default file extension of dataId in spring-cloud-starter-alicloud-acm is properties. In addition to properties,  yaml is also supported.
You can set the file extension using spring.cloud.alicloud.acm.file-extension. Just set it to <code class="literal">yaml</code> or `yml`for yaml format.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>After you change the file extension, you need to make corresponding format changes in the DataID and content of the configuration center.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_dynamic_configuration_refresh" href="#_dynamic_configuration_refresh"></a>9.4&nbsp;Dynamic Configuration Refresh</h2></div></div></div><p>spring-cloud-starter-alicloud-acm supports dynamic configuration updates. RefreshEvent in Spring is published when you update configuration in the configuration center.
All classes with @RefreshScope and @ConfigurationProperties annotations will be refreshed automatically.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>You can disable automatic refresh by this setting: spring.cloud.alicloud.acm.refresh.enabled=false</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_configure_profile_granularity" href="#_configure_profile_granularity"></a>9.5&nbsp;Configure Profile Granularity</h2></div></div></div><p>When configuration is loaded by spring-cloud-starter-alicloud-acm, configuration with DataId {spring.application.name}. {file-extension} will be loaded first. If there is content in spring.profiles.active, the content of spring.profile, and configuration with the dataid format of{spring.application.name}-{profile}. {file-extension} will also be loaded in turn, and the latter has higher priority.</p><p>spring.profiles.active is the configuration metadata, and should also be configured in bootstrap.properties or bootstrap.yaml. For example, you can add the following content in bootstrap.properties.</p><pre class="screen">spring.profiles.active={profile-name}</pre><p>Note: You can also configure the granularity through JVM parameters such as -Dspring.profiles.active=develop or --spring.profiles.active=develop, which have higher priority. Just follow the specifications of Spring Boot.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_support_custom_acm_timeout" href="#_support_custom_acm_timeout"></a>9.6&nbsp;Support Custom ACM Timeout</h2></div></div></div><p>the default timeout of ACM client get config from sever is 3000 ms . If you need to define a timeout, set configuration <code class="literal">spring.cloud.alicloud.acm.timeout</code>,the unit is millisecond.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_support_custom_group_configurations" href="#_support_custom_group_configurations"></a>9.7&nbsp;Support Custom Group Configurations</h2></div></div></div><p>DEFAULT_GROUP is used by default when no <code class="literal">{spring.cloud.alicloud.acm.group}</code> configuration is defined. If you need to define your own group, you can use the following method:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.acm.group</span>=DEVELOP_GROUP</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>This configuration must be placed in the bootstrap.properties file, and the value of Group must be the same with the value of <code class="literal">spring.cloud.alicloud.acm.group</code>.</p></td></tr></table></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_support_shared_configurations" href="#_support_shared_configurations"></a>9.7.1&nbsp;Support Shared Configurations</h3></div></div></div><p>ACM provides a solution to share the same configuration across multiple applications. You can do this by adding the <code class="literal">spring.application.group</code> configuration in Bootstrap.</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.application.group</span>=company.department.team</pre><p>Then, you application will retrieve configurations from the following DataId in turn before it retrieves its own configuration: company:application.properties, company.department:application.properties, company.department.team:application.properties.
After that, it also retrieves configuration from  {spring.application.group}: {spring.application.name}. {file-extension}
The later in order, the higer the priority, and the unique configuration of the application itself has the highest priority.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The default suffix of DataId is properties, and you can change it using spring.cloud.alicloud.acm.file-extension. <code class="literal">{spring.application.group}: {spring.application.name}. {file-extension}</code> .</p></td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>If you configured <code class="literal">spring.profiles.active</code> , then the DataId format of <code class="literal">{spring.application.group}: {spring.application.name}-{spring.profiles.active}. {file-extension}</code> is also supported, and has higher priority than <code class="literal">{spring.application.group}: {spring.application.name}. {file-extension}</code></p></td></tr></table></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_actuator_endpoint" href="#_actuator_endpoint"></a>9.8&nbsp;Actuator Endpoint</h2></div></div></div><p>the Actuator endpoint of ACM is <code class="literal">/acm</code>, <code class="literal">config</code> represents the ACM metadata configuration information, <code class="literal">runtime.sources</code> corresponds to the configuration information obtained from the ACM server and the last refresh time, <code class="literal">runtime.refreshHistory</code> corresponds to the dynamic refresh history.</p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="_spring_cloud_alibaba_cloud_oss" href="#_spring_cloud_alibaba_cloud_oss"></a>10.&nbsp;Spring Cloud Alibaba Cloud OSS</h1></div></div></div><p>OSS&#65288;Object Storage Service&#65289;is a storage product on Alibaba Cloud. Spring Cloud Alibaba Cloud OSS provides the commercialized storage service in conformity with Spring Cloud specifications. We provide easy-to-use APIs and supports the integration of Resource in the Spring framework.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_how_to_introduce_spring_cloud_alibaba_cloud_oss" href="#_how_to_introduce_spring_cloud_alibaba_cloud_oss"></a>10.1&nbsp;How to Introduce Spring Cloud Alibaba Cloud OSS</h2></div></div></div><p>We&#8217;ve released Spring Cloud Alibaba version 0.2.1. You will need to add dependency management POM first.</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependencyManagement&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependencies&gt;</span>
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependency&gt;</span>
            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;groupId&gt;</span>com.alibaba.cloud<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/groupId&gt;</span>
            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;artifactId&gt;</span>spring-cloud-alibaba-dependencies<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/artifactId&gt;</span>
            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;version&gt;</span>0.2.2.BUILD-SNAPSHOT<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/version&gt;</span>
            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;type&gt;</span>pom<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/type&gt;</span>
            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;scope&gt;</span>import<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/scope&gt;</span>
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependency&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependencies&gt;</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependencyManagement&gt;</span></pre><p>Next we need to introduce Spring Cloud Alibaba Cloud OSS Starter.</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependency&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;groupId&gt;</span>com.alibaba.cloud<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/groupId&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;artifactId&gt;</span>spring-cloud-starter-alicloud-oss<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/artifactId&gt;</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependency&gt;</span></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_how_to_use_oss_api" href="#_how_to_use_oss_api"></a>10.2&nbsp;How to Use OSS API</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_configure_oss" href="#_configure_oss"></a>10.2.1&nbsp;Configure OSS</h3></div></div></div><p>Before you start to use Spring Cloud Alibaba Cloud OSS, please add the following configurations in application.properties.</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.access-key</span>=Your Alibaba Cloud AK
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.secret-key</span>=Your Alibaba Cloud SK
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.oss.endpoint</span>=***.aliyuncs.com</pre><p>access-key and secret-key is the AK/SK of your Alibaba Cloud account. If you don&#8217;t have one, please register an account first, and log on to <a class="link" href="https://usercenter.console.aliyun.com/#/manage/ak" target="_top">Alibaba Cloud AK/SK Management</a> to get your AccessKey ID and Access Key Secret . If you haven&#8217;t create the AccessKeys, click &#8220;Create AccessKey&#8221; to create one.</p><p>For endpoint information, please refer to the OSS <a class="link" href="https://help.aliyun.com/document_detail/31837.html" target="_top">Documentation</a> and get the endpoint for your region.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_introduce_oss_api" href="#_introduce_oss_api"></a>10.2.2&nbsp;Introduce OSS API</h3></div></div></div><p>The OSS API of Spring Cloud Alibaba Cloud OSS is based on the official OSS SDK, and includes APIs for uploading, downloading, viewing files.</p><p>Here is a simple application that uses the OSS API.</p><pre class="programlisting"><xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@SpringBootApplication</xslthl:annotation>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span> OssApplication {

    <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Autowired</xslthl:annotation>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">private</span> OSS ossClient;

    <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@RequestMapping("/")</xslthl:annotation>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> String home() {
        ossClient.putObject(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"bucketName"</span>, <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"fileName"</span>, <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">new</span> FileInputStream(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"/your/local/file/path"</span>));
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">return</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"upload success"</span>;
    }

    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">static</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">void</span> main(String[] args) <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">throws</span> URISyntaxException {
        SpringApplication.run(OssApplication.<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span>, args);
    }

}</pre><p>Before you upload your files, please  <a class="link" href="https://account.aliyun.com/register/register.htm?spm=5176.8142029.388261.26.e9396d3eaYK2sG&amp;oauth_callback=https%3A%2F%2Fwww.aliyun.com%2F" target="_top">Register an Alibaba Cloud Account</a>. If you already have one, please  <a class="link" href="https://common-buy.aliyun.com/?spm=5176.8465980.unusable.dopen.4cdf1450rg8Ujb&amp;commodityCode=oss#/open" target="_top">Sign up for OSS</a>.</p><p>Log on to the <a class="link" href="https://oss.console.aliyun.com/overview" target="_top">OSS Console</a>, click &#8220;Create New Bucket&#8221; and create a bucket as instructed. Replace the bucket name in the &#8220;bucketname&#8221; of the previous code with your new bucket name.  "fileName&#8221; can be any name you like, and "/your/local/file/path&#8221; can be any local file path. Next you can run `curl <a class="link" href="http://127.0.0.1:port" target="_top">http://127.0.0.1:port</a> number/ to upload your files, and you will see your file on the <a class="link" href="https://oss.console.aliyun.com/overview" target="_top">OSS Console</a>.</p><p>For more instructions on OSS APIs, please refer to <a class="link" href="https://help.aliyun.com/document_detail/32008.html" target="_top">OSS SDK Documentation</a>.</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_integrate_with_the_resource_specifications_of_spring" href="#_integrate_with_the_resource_specifications_of_spring"></a>10.3&nbsp;Integrate with the Resource Specifications of Spring</h2></div></div></div><p>Spring Cloud Alibaba Cloud OSS integrates the Resource of the Spring framework, which allows you to use the OSS resources easily.</p><p>The following is a simple example of how to use Resource.</p><pre class="programlisting"><xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@SpringBootApplication</xslthl:annotation>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span> OssApplication {

    <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Value("oss://bucketName/fileName")</xslthl:annotation>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">private</span> Resource file;

    <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@GetMapping("/file")</xslthl:annotation>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> String fileResource() {
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">try</span> {
            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">return</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"get file resource success. content: "</span> + StreamUtils.copyToString(
                file.getInputStream(), Charset.forName(CharEncoding.UTF_<xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">8</xslthl:number>));
        } <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">catch</span> (Exception e) {
            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">return</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"get resource fail: "</span> + e.getMessage();
        }
    }

    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">static</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">void</span> main(String[] args) <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">throws</span> URISyntaxException {
        SpringApplication.run(OssApplication.<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span>, args);
    }

}</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>A prerequisite for the above sample is that you need to have a bucket named &#8220;bucketName&#8221; on OSS, and you have a file named &#8220;fileName&#8221; in this bucket.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_use_sts_authentication" href="#_use_sts_authentication"></a>10.4&nbsp;Use STS Authentication</h2></div></div></div><p>In addition to AccessKeys, Spring Cloud Alibaba Cloud OSS also supports STS authentication. STS is an authentication method with temporary security tokens, and is usually used for a third party to access its resources temporarily.</p><p>For a third party to access resources temporarily, it only needs to complete the following configurations.</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.oss.authorization-mode</span>=STS
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.oss.endpoint</span>=***.aliyuncs.com
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.oss.sts.access-key</span>=Your authenticated AK
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.oss.sts.secret-key</span>=Your authenticated SK
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.oss.sts.security-token</span>=Your authenticated ST</pre><p>Among which, spring.cloud.alicloud.oss.authorization-mode is the enumeration type. Fill in STS here means that STS authentication is used. For endpoint information, refer to the <a class="link" href="https://help.aliyun.com/document_detail/31837.html" target="_top">OSS Documentation</a> and fill in the endpoint for your region.</p><p>Access-key, secret-key and the security-token need to be issued by the authentication side. For more information about STS, refer to <a class="link" href="https://help.aliyun.com/document_detail/31867.html" target="_top">STS Documentation</a>.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_more_configurations_for_the_client" href="#_more_configurations_for_the_client"></a>10.5&nbsp;More Configurations for the Client</h2></div></div></div><p>In addition to basic configurations, Spring Cloud Alibaba Cloud OSS also supports many other configurations, which are also included in the application.properties file.</p><p>Here are some examples.</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.oss.authorization-mode</span>=STS
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.oss.endpoint</span>=***.aliyuncs.com
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.oss.sts.access-key</span>=Your authenticated AK
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.oss.sts.secret-key</span>=Your authenticated SK
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.oss.sts.security-token</span>=Your authenticated ST

<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.oss.config.connection-timeout</span>=3000
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.oss.config.max-connections</span>=1000</pre><p>For more configurations, refer to  the table at the bottom of <a class="link" href="https://help.aliyun.com/document_detail/32010.html" target="_top">OSSClient Configurations</a>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>In most cases, you need to connect the parameter names with &#8220;-&#8221; for the parameters in the table of <a class="link" href="https://help.aliyun.com/document_detail/32010.html" target="_top">OSSClient Configurations</a> with &#8220;-&#8221;, and all letters should be in lowercase. For example, ConnectionTimeout should be changed to connection-timeout.</p></td></tr></table></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="_spring_cloud_alibaba_cloud_schedulerx" href="#_spring_cloud_alibaba_cloud_schedulerx"></a>11.&nbsp;Spring Cloud Alibaba Cloud SchedulerX</h1></div></div></div><p>SchedulerX&#65288;Distributed job scheduling&#65289; is a component of EDAS, an Alibaba Cloud product. Spring Cloud Alibaba Cloud SchedulerX provides distributed job scheduling in conformity with the Spring Cloud specifications. SchedulerX provides timed job scheduling service with high accuracy with seconds, high stability and high availabiliy, and supports multiple job types, such as simple single-server jobs, simple multi-host jobs, script jobs, and grid jobs.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_how_to_introduce_spring_cloud_alibaba_cloud_schedulerx" href="#_how_to_introduce_spring_cloud_alibaba_cloud_schedulerx"></a>11.1&nbsp;How to Introduce Spring Cloud Alibaba Cloud SchedulerX</h2></div></div></div><p>If you want to use SchedulerX in your project, please use the starter with the group ID as <code class="literal">com.alibaba.cloud</code> and the artifact ID as <code class="literal">spring-cloud-starter-alicloud-schedulerX</code>.</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependency&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;groupId&gt;</span>com.alibaba.cloud<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/groupId&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;artifactId&gt;</span>spring-cloud-starter-alicloud-schedulerX<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/artifactId&gt;</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependency&gt;</span></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_start_schedulerx" href="#_start_schedulerx"></a>11.2&nbsp;Start SchedulerX</h2></div></div></div><p>After Spring Cloud Alibaba Cloud SchedulerX Starter is introduced into the client, you only need to complete a few simple configurations and you will be able to initialize the SchedulerX service automatically.</p><p>The following is a simple example.</p><pre class="programlisting"><xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@SpringBootApplication</xslthl:annotation>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span> ScxApplication {

    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">static</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">void</span> main(String[] args) {
        SpringApplication.run(ScxApplication.<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span>, args);
    }

}</pre><p>Add the following configurations in the application.properties file.</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">server.port</span>=18033
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment"># cn-test is the test region of SchedulerX</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.scx.group-id</span>=***
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.edas.namespace</span>=cn-test</pre><p>Before getting the group-id, please <a class="link" href="https://account.aliyun.com/register/register.htm?spm=5176.8142029.388261.26.e9396d3eEIv28g&amp;oauth_callback=https%3A%2F%2Fwww.aliyun.com%2F" target="_top">Register an Alibaba Cloud account</a>, and then <a class="link" href="https://common-buy.aliyun.com/?spm=5176.11451019.0.0.6f5965c0Uq5tue&amp;commodityCode=edaspostpay#/buy" target="_top">Sign up for EDAS</a> and <a class="link" href="https://edas.console.aliyun.com/#/edasTools" target="_top">Sign up for SchedulerX</a> as well.</p><p>To get the group-id, refer to the <a class="link" href="https://help.aliyun.com/document_detail/98784.html" target="_top">SchedulerX Documentation</a>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>When you create a group, please select the &#8220;test&#8221; region.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_compile_a_simple_job" href="#_compile_a_simple_job"></a>11.3&nbsp;Compile a simple job</h2></div></div></div><p>Simple job is the most commonly used job type. You only need to implement the ScxSimpleJobProcessor interface.</p><p>The following is a sample of a simple single-server job.</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span> SimpleTask <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">implements</span> ScxSimpleJobProcessor {

	<xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Override</xslthl:annotation>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> ProcessResult process(ScxSimpleJobContext context) {
		System.out.println(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"-----------Hello world---------------"</span>);
		ProcessResult processResult = <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">new</span> ProcessResult(true);
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">return</span> processResult;
	}

}</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_job_scheduling" href="#_job_scheduling"></a>11.4&nbsp;Job Scheduling</h2></div></div></div><p>Go to the <a class="link" href="https://edas.console.aliyun.com/#/edasSchedulerXJob?regionNo=cn-test" target="_top">SchedulerX Jobs</a> page, select the &#8220;Test&#8221; region, and click &#8220;Create Job&#8221; on the upper-right corner to create a job, as shown below.</p><pre class="programlisting">Job Group&#65306; Test&#8212;&#8212;***-*-*-****
Job process interface&#65306;SimpleTask
Type&#65306; Simple Single-Server Job
Quartz Cron Expression&#65306; Default Option&#8212;&#8212;0 * * * * ?
Job Description&#65306; Empty
Custom Parameters&#65306; Empty</pre><p>The job above is a &#8220;Simple Single-Server Job&#8221;, and speficied a Cron expression of "0 * * * * ?" . This means that the job will be executed once and once only in every minute.</p><p>For more job types, refer to <a class="link" href="https://help.aliyun.com/document_detail/43136.html" target="_top">SchedulerX Documentation</a>.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_usage_in_production_environment" href="#_usage_in_production_environment"></a>11.5&nbsp;Usage in Production Environment</h2></div></div></div><p>The previous examples shows how to use SchedulerX in the &#8220;Test&#8221; region, which is mainly used for local testing.</p><p>At the production level, you need to complete some other configurations in addition to the group-id and namespace as mentioned above. See examples below:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">server.port</span>=18033
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment"># cn-test is the test region of SchedulerX</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.scx.group-id</span>=***
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.edas.namespace</span>=***
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment"># If your application runs on EDAS, you do not need to configure the following.</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.access-key</span>=***
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.secret-key</span>=***
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment"># The following configurations are not mandatory. You can refer to the SchedulerX documentation for details.</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.scx.domain-name</span>=***</pre><p>The way to get the group-id is the same as described in the previous examples, and you can get the namespace by clicking &#8220;Namespaces&#8221; in the left-side navigation pane of the EDAS console.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Group-id must be created within a namespace.</p></td></tr></table></div><p>Access-key and secret-key are the AK/SK of your Alibaba Cloud account. If you deploy you applications on EDAS, then you do not need to fill in this information. Otherwise please go to  <a class="link" href="https://usercenter.console.aliyun.com/#/manage/ak" target="_top">Security Information</a> to get your AccessKeys.</p><p>Domain-name is not mandatory. You can refer to  <a class="link" href="https://help.aliyun.com/document_detail/35359.html" target="_top">SchedulerX Documentation</a> for details.</p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="_spring_cloud_alibaba_cloud_sms" href="#_spring_cloud_alibaba_cloud_sms"></a>12.&nbsp;Spring Cloud Alibaba Cloud SMS</h1></div></div></div><p>SMS&#65288;Short Message Service&#65289;is a messaging service that covers the globe, Alibaba SMS provides convenient, efficient, and intelligent communication capabilities that help businesses quickly contact their customers.</p><p>Spring Cloud Alibaba Cloud SMS provide an easier-to-use API for quick access to Alibaba Cloud&#8217;s SMS service based on Spring Cloud Alibaba SMS.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_how_to_introduce_spring_cloud_alibaba_cloud_sms" href="#_how_to_introduce_spring_cloud_alibaba_cloud_sms"></a>12.1&nbsp;How to Introduce Spring Cloud Alibaba Cloud SMS</h2></div></div></div><p>If you want to use SMS in your project, please use the starter with the group ID as <code class="literal">com.alibaba.cloud</code> and the artifact ID as <code class="literal">spring-cloud-starter-alicloud-sms</code>.</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;dependency&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;groupId&gt;</span>com.alibaba.cloud<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/groupId&gt;</span>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;artifactId&gt;</span>spring-cloud-starter-alicloud-sms<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/artifactId&gt;</span>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-tag">&lt;/dependency&gt;</span></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_how_to_use_sms_api" href="#_how_to_use_sms_api"></a>12.2&nbsp;How to use SMS API</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_configure_sms" href="#_configure_sms"></a>12.2.1&nbsp;Configure SMS</h3></div></div></div><p>Before you start to use Spring Cloud Alibaba Cloud SMS, please add the following configurations in application.properties.</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.access-key</span>=AK
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">spring.cloud.alicloud.secret-key</span>=SK</pre><p>access-key and secret-key is the AK/SK of your Alibaba Cloud account. If you don&#8217;t have one, please register an account first, and log on to <a class="link" href="https://usercenter.console.aliyun.com/#/manage/ak" target="_top">Alibaba Cloud AK/SK Management</a> to get your AccessKey ID and Access Key Secret . If you haven&#8217;t create the AccessKeys, click &#8220;Create AccessKey&#8221; to create one.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_introduce_sms_api" href="#_introduce_sms_api"></a>12.2.2&nbsp;Introduce SMS API</h3></div></div></div><p>The SMS API in Spring Cloud Alicloud SMS is based on Alibaba Cloud SMS SDK. It has a single SMS sending, multiple SMS bulk sending, SMS query, SMS message (SMS receipt message and Upstream SMS message) class operation API.</p><p>The following is a simple example of how to use SMS api to send short message:</p><pre class="programlisting"><xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@SpringBootApplication</xslthl:annotation>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span> SmsApplication {

    <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Autowired</xslthl:annotation>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">private</span> ISmsService smsService;

    <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@RequestMapping("/batch-sms-send.do")</xslthl:annotation>
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> SendBatchSmsResponse batchsendCheckCode(
            <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@RequestParam(name = "code")</xslthl:annotation> String code) {

        SendSmsRequest request = <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">new</span> SendSmsRequest();
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment">// Required:the mobile number</span>
        request.setPhoneNumbers(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"152******"</span>);
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment">// Required:SMS-SignName-could be found in sms console</span>
        request.setSignName(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"******"</span>);
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment">// Required:Template-could be found in sms console</span>
        request.setTemplateCode(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"******"</span>);
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment">// Required:The param of sms template.For exmaple, if the template is "Hello,your verification code is ${code}". The param should be like following value</span>
        request.setTemplateParam(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"{\"code\":\""</span> + code + <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"\"}"</span>);
        SendSmsResponse sendSmsResponse ;
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">try</span> {
            sendSmsResponse = smsService.sendSmsRequest(request);
        }
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">catch</span> (ClientException e) {
            e.printStackTrace();
            sendSmsResponse = <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">new</span> SendSmsResponse();
        }
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">return</span> sendSmsResponse ;
    }

    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">static</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">void</span> main(String[] args) <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">throws</span> URISyntaxException {
        SpringApplication.run(SmsApplication.<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span>, args);
    }

}</pre><p>Before you send your messages, please <a class="link" href="https://account.aliyun.com/register/register.htm?spm=5176.8142029.388261.26.e9396d3eaYK2sG&amp;oauth_callback=https%3A%2F%2Fwww.aliyun.com%2F" target="_top">Register an Alibaba Cloud Account</a>. If you already have one, please  <a class="link" href="https://dysms.console.aliyun.com/dysms.htm?spm=5176.8195934.1283918..18924183bHPct2&amp;accounttraceid=c8cb4243-3080-4eb1-96b0-1f2316584269#/" target="_top">Turn on SMS Service</a>.</p><p>For more information about SMS , please refer to the SMS official <a class="link" href="https://help.aliyun.com/document_detail/55284.html?spm=a2c4g.11186623.6.568.715e4f30ZiVkbI" target="_top">SMS</a> (SendSms)---JAVA] docs .</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>Due to an issue with the earlier SMS sdk version, if the text message fails to be sent, please delete the line of code that contains the explicit MethodType as POST. If you still have problems, please contact us as soon as possible.</p></td></tr></table></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_the_advanced_features_of_sms_api" href="#_the_advanced_features_of_sms_api"></a>12.3&nbsp;The Advanced Features of SMS Api</h2></div></div></div><p>In order to reduce the cost of learning, the API interface of the Spring Cloud Alicloud SMS package is kept as consistent as the API and Example provided by the official website.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Batch SMS sending</li></ul></div><p>Refer to the following example to quickly develop a feature with bulk SMS sending. Add the following code in the Controller or create a new Controller:</p><pre class="programlisting"><xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@RequestMapping("/batch-sms-send.do")</xslthl:annotation>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> SendBatchSmsResponse batchsendCheckCode(
        <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@RequestParam(name = "code")</xslthl:annotation> String code) {
    SendBatchSmsRequest request = <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">new</span> SendBatchSmsRequest();
    request.setMethod(MethodType.GET);
    request.setPhoneNumberJson(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"[\"177********\",\"130********\"]"</span>);
    request.setSignNameJson(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"[\"*******\",\"*******\"]"</span>);
    request.setTemplateCode(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"******"</span>);
    request.setTemplateParamJson(
            <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"[{\"code\":\""</span> + code + <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"\"},{\"code\":\""</span> + code + <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"\"}]"</span>);
    SendBatchSmsResponse sendSmsResponse ;
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">try</span> {
        sendSmsResponse = smsService
                .sendSmsBatchRequest(request);
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">return</span> sendSmsResponse;
    }
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">catch</span> (ClientException e) {
        e.printStackTrace();
        sendSmsResponse =  <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">new</span> SendBatchSmsResponse();
    }
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">return</span> sendSmsResponse ;
}</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>The MethodType of the request is set to GET, which is somewhat different from the example given by the official website. This is because the inconsistent version of the dependent Alibaba Cloud POP API version causes incompatibility issues, set to GET.</p></td></tr></table></div><p>More parameter descriptions can be <a class="link" href="https://help.aliyun.com/document_detail/66041.html?spm=a2c4g.11186623.6.571.631315e8AauJhP" target="_top">reference here</a></p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">SMS Query</li></ul></div><p>Refer to the following example to quickly develop a history of sending SMS messages based on a specified number. Add the following code in the Controller or create a new Controller:</p><pre class="programlisting"><xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@RequestMapping("/query.do")</xslthl:annotation>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> QuerySendDetailsResponse querySendDetailsResponse(
        <xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@RequestParam(name = "tel")</xslthl:annotation> String telephone) {
    QuerySendDetailsRequest request = <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">new</span> QuerySendDetailsRequest();
    request.setPhoneNumber(telephone);
    request.setSendDate(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"20190103"</span>);
    request.setPageSize(<xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">10L</xslthl:number>);
    request.setCurrentPage(<xslthl:number xmlns:xslthl="http://xslthl.sourceforge.net/">1L</xslthl:number>);
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">try</span> {
        QuerySendDetailsResponse response = smsService.querySendDetails(request);
        <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">return</span> response;
    }
    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">catch</span> (ClientException e) {
        e.printStackTrace();
    }

    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">return</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">new</span> QuerySendDetailsResponse();
}</pre><p>More parameter descriptions can be found at <a class="link" href="https://help.aliyun.com/document_detail/55289.html?spm=a2c4g.11186623.6.569.4f852c78mugEfx" target="_top">reference here</a></p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">SMS receipt message</li></ul></div><p>By subscribing to the SmsReport SMS status report, you can know the status of each SMS message and whether it knows the status and related information of the terminal user. These efforts have been encapsulated internally by Spring Cloud AliCloud SMS. You only need to complete the following two steps.</p><p>1&#12289;Configure the queue name for SmsReport in the <code class="literal">application.properties</code> configuration file (which can also be application.yaml).</p><p><b>application.properties.&nbsp;</b>
</p><pre class="screen">spring.cloud.alicloud.sms.report-queue-name=Alicom-Queue-********-SmsReport</pre><p>
</p><p>2&#12289;Implement the SmsReportMessageListener interface and initialize a Spring Bean.</p><pre class="programlisting"><xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Component</xslthl:annotation>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span> SmsReportMessageListener
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">implements</span> SmsReportMessageListener {

	<xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Override</xslthl:annotation>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">boolean</span> dealMessage(Message message) {
	    <span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment">//do something</span>
		System.err.println(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">this</span>.getClass().getName() + <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"; "</span> + message.toString());
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">return</span> true;
	}
}</pre><p>More message body format for Message can be <a class="link" href="https://help.aliyun.com/document_detail/55496.html?spm=a2c4g.11186623.6.570.7f792c78rOiWXO" target="_top">reference here</a>.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">Upstream SMS message</li></ul></div><p>By subscribing to the SmsUp upstream SMS message, you can know the content of the end user replying to the SMS. These efforts have also been packaged by Spring Cloud AliCloud SMS. You only need to complete the following two steps.</p><p>1&#12289;Configure the queue name for SmsReport in the <code class="literal">application.properties</code> configuration file (which can also be application.yaml).</p><p><b>application.properties.&nbsp;</b>
</p><pre class="screen">spring.cloud.alicloud.sms.up-queue-name=Alicom-Queue-********-SmsUp</pre><p>
</p><p>2&#12289;Implement the SmsUpMessageListener interface and initialize a Spring Bean.</p><pre class="programlisting"><xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Component</xslthl:annotation>
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">class</span> SmsUpMessageListener
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">implements</span> org.springframework.cloud.alicloud.sms.SmsUpMessageListener {

	<xslthl:annotation xmlns:xslthl="http://xslthl.sourceforge.net/">@Override</xslthl:annotation>
	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">public</span> <span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">boolean</span> dealMessage(Message message) {
    	<span xmlns:d="http://docbook.org/ns/docbook" class="hl-comment">//do something</span>
		System.err.println(<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">this</span>.getClass().getName() + <span xmlns:d="http://docbook.org/ns/docbook" class="hl-string">"; "</span> + message.toString());
		<span xmlns:d="http://docbook.org/ns/docbook" class="hl-keyword">return</span> true;
	}
}</pre><p>More message body format for Message can be <a class="link" href="https://help.aliyun.com/document_detail/55496.html?spm=a2c4g.11186623.6.570.7f792c78rOiWXO" target="_top">reference here</a>.</p></div></div></div></body></html>